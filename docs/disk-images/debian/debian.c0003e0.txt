if ")
        self.traverse(node.test)
        with self.block():
            self.traverse(node.body)
        # collapse nested ifs into equivalent elifs.
        while node.orelse and len(node.orelse) == 1 and isinstance(node.orelse[0], If):
            node = node.orelse[0]
            self.fill("elif ")
            self.traverse(node.test)
            with self.block():
                self.traverse(node.body)
        # final else
        if node.orelse:
            self.fill("else")
            with self.block():
                self.traverse(node.orelse)

    def visit_While(self, node):
        self.fill("while ")
        self.traverse(node.test)
        with self.block():
            self.traverse(node.body)
        if node.orelse:
            self.fill("else")
            with self.block():
                self.traverse(node.orelse)

    def visit_With(self, node):
        self.fill("with ")
        self.interleave(lambda: self.write(", "), self.traverse, node.items)
        with self.block(extra=self.get_type_comment(node)):
            self.traverse(node.body)

    def visit_AsyncWith(self, node):
        self.fill("async with ")
        self.interleave(lambda: self.write(", "), self.traverse, node.items)
        with self.block(extra=self.get_type_comment(node)):
            self.traverse(node.body)

    def _str_literal_helper(
        self, string, *, quote_types=_ALL_QUOTES, escape_special_whitespace=False
    ):
        """Helper for writing string literals, minimizing escapes.
        Returns the tuple (string literal to write, possible quote types).
        """
        def escape_char(c):
            # \n and \t are non-printable, but we only escape them if
            # escape_special_whitespace is True
            if not escape_special_whitespace and c in "\n\t":
                return c
            # Always escape backslashes and other non-printable characters
            if c == "\\" or not c.isprintable():
                return c.encode("unicode_escape").decode("ascii")
            return c

        escaped_string = "".join(map(escape_char, string))
        possible_quotes = quote_types
        if "\n" in escaped_string:
            possible_quotes = [q for q in possible_quotes if q in _MULTI_QUOTES]
        possible_quotes = [q for q in possible_quotes if q not in escaped_string]
        if not possible_quotes:
            # If there aren't any possible_quotes, fallback to using repr
            # on the original string. Try to use a quote from quote_types,
            # e.g., so that we use triple quotes for docstrings.
            string = repr(string)
            quote = next((q for q in quote_types if string[0] in q), string[0])
            return string[1:-1], [quote]
        if escaped_string:
            # Sort so that we prefer '''"''' over """\""""
            possible_quotes.sort(key=lambda q: q[0] == escaped_string[-1])
            # If we're using triple quotes and we'd need to escape a final
            # quote, escape it
            if possible_quotes[0][0] == escaped_string[-1]:
                assert len(possible_quotes[0]) == 3
                escaped_string = escaped_string[:-1] + "\\" + escaped_string[-1]
        return escaped_string, possible_quotes

    def _write_str_avoiding_backslashes(self, string, *, quote_types=_ALL_QUOTES):
        """Write string literal value with a best effort attempt to avoid backslashes."""
        string, quote_types = self._str_literal_helper(string, quote_types=quote_types)
        quote_type = quote_types[0]
        self.write(f"{quote_type}{string}{quote_type}")

    def visit_JoinedStr(self, node):
        self.write("f")
        if self._avoid_backslashes:
            with self.buffered() as buffer:
                self._write_fstring_inner(node)
            return self._write_str_avoiding_backslashes("".join(buffer))

        # If we don't need to avoid backslashes globally (i.e., we only need
        # to avoid them inside FormattedValues), it's cosmetically preferred
        # to use escaped whitespace. That is, it's preferred to use backslashes
        # for cases like: f"{x}\n". To accomplish this, we keep track of what
        # in our buffer corresponds to FormattedValues and what corresponds to
        # Constant parts of the f-string, and allow escapes accordingly.
        fstring_parts = []
        for value in node.values:
            with self.buffered() as buffer:
                self._write_fstring_inner(value)
            fstring_parts.append(
                ("".join(buffer), isinstance(value, Constant))
            )

        new_fstring_parts = []
        quote_types = list(_ALL_QUOTES)
        for value, is_constant in fstring_parts:
            value, quote_types = self._str_literal_helper(
                value,
                quote_types=quote_types,
                escape_special_whitespace=is_constant,
            )
            new_fstring_parts.append(value)

        value = "".join(new_fstring_parts)
        quote_type = quote_types[0]
        self.write(f"{quote_type}{value}{quote_type}")

    def _write_fstring_inner(self, node):
        if isinstance(node, JoinedStr):
            # for both the f-string itself, and format_spec
            for value in node.values:
                self._write_fstring_inner(value)
        elif isinstance(node, Constant) and isinstance(node.value, str):
            value = node.value.replace("{", "{{").replace("}", "}}")
            self.write(value)
        elif isinstance(node, FormattedValue):
            self.visit_FormattedValue(node)
        else:
            raise ValueError(f"Unexpected node inside JoinedStr, {node!r}")

    def visit_FormattedValue(self, node):
        def unparse_inner(inner):
            unparser = type(self)(_avoid_backslashes=True)
            unparser.set_precedence(_Precedence.TEST.next(), inner)
            return unparser.visit(inner)

        with self.delimit("{", "}"):
            expr = unparse_inner(node.value)
            if "\\" in expr:
                raise ValueError(
                    "Unable to avoid backslash in f-string expression part"
                )
            if expr.startswith("{"):
                # Separate pair of opening brackets as "{ {"
                self.write(" ")
            self.write(expr)
            if node.conversion != -1:
                self.write(f"!{chr(node.conversion)}")
            if node.format_spec:
                self.write(":")
                self._write_fstring_inner(node.format_spec)

    def visit_Name(self, node):
        self.write(node.id)

    def _write_docstring(self, node):
        self.fill()
        if node.kind == "u":
            self.write("u")
        self._write_str_avoiding_backslashes(node.value, quote_types=_MULTI_QUOTES)

    def _write_constant(self, value):
        if isinstance(value, (float, complex)):
            # Substitute overflowing decimal literal for AST infinities,
            # and inf - inf for NaNs.
            self.write(
                repr(value)
                .replace("inf", _INFSTR)
                .replace("nan", f"({_INFSTR}-{_INFSTR})")
            )
        elif self._avoid_backslashes and isinstance(value, str):
            self._write_str_avoiding_backslashes(value)
        else:
            self.write(repr(value))

    def visit_Constant(self, node):
        value = node.value
        if isinstance(value, tuple):
            with self.delimit("(", ")"):
                self.items_view(self._write_constant, value)
        elif value is ...:
            self.write("...")
        else:
            if node.kind == "u":
                self.write("u")
            self._write_constant(node.value)

    def visit_List(self, node):
        with self.delimit("[", "]"):
            self.interleave(lambda: self.write(", "), self.traverse, node.elts)

    def visit_ListComp(self, node):
        with self.delimit("[", "]"):
            self.traverse(node.elt)
            for gen in node.generators:
                self.traverse(gen)

    def visit_GeneratorExp(self, node):
        with self.delimit("(", ")"):
            self.traverse(node.elt)
            for gen in node.generators:
                self.traverse(gen)

    def visit_SetComp(self, node):
        with self.delimit("{", "}"):
            self.traverse(node.elt)
            for gen in node.generators:
                self.traverse(gen)

    def visit_DictComp(self, node):
        with self.delimit("{", "}"):
            self.traverse(node.key)
            self.write(": ")
            self.traverse(node.value)
            for gen in node.generators:
                self.traverse(gen)

    def visit_comprehension(self, node):
        if node.is_async:
            self.write(" async for ")
        else:
            self.write(" for ")
        self.set_precedence(_Precedence.TUPLE, node.target)
        self.traverse(node.target)
        self.write(" in ")
        self.set_precedence(_Precedence.TEST.next(), node.iter, *node.ifs)
        self.traverse(node.iter)
        for if_clause in node.ifs:
            self.write(" if ")
            self.traverse(if_clause)

    def visit_IfExp(self, node):
        with self.require_parens(_Precedence.TEST, node):
            self.set_precedence(_Precedence.TEST.next(), node.body, node.test)
            self.traverse(node.body)
            self.write(" if ")
            self.traverse(node.test)
            self.write(" else ")
            self.set_precedence(_Precedence.TEST, node.orelse)
            self.traverse(node.orelse)

    def visit_Set(self, node):
        if node.elts:
            with self.delimit("{", "}"):
                self.interleave(lambda: self.write(", "), self.traverse, node.elts)
        else:
            # `{}` would be interpreted as a dictionary literal, and
            # `set` might be shadowed. Thus:
            self.write('{*()}')

    def visit_Dict(self, node):
        def write_key_value_pair(k, v):
            self.traverse(k)
            self.write(": ")
            self.traverse(v)

        def write_item(item):
            k, v = item
            if k is None:
                # for dictionary unpacking operator in dicts {**{'y': 2}}
                # see PEP 448 for details
                self.write("**")
                self.set_precedence(_Precedence.EXPR, v)
                self.traverse(v)
            else:
                write_key_value_pair(k, v)

        with self.delimit("{", "}"):
            self.interleave(
                lambda: self.write(", "), write_item, zip(node.keys, node.values)
            )

    def visit_Tuple(self, node):
        with self.delimit_if(
            "(",
            ")",
            len(node.elts) == 0 or self.get_precedence(node) > _Precedence.TUPLE
        ):
            self.items_view(self.traverse, node.elts)

    unop = {"Invert": "~", "Not": "not", "UAdd": "+", "USub": "-"}
    unop_precedence = {
        "not": _Precedence.NOT,
        "~": _Precedence.FACTOR,
        "+": _Precedence.FACTOR,
        "-": _Precedence.FACTOR,
    }

    def visit_UnaryOp(self, node):
        operator = self.unop[node.op.__class__.__name__]
        operator_precedence = self.unop_precedence[operator]
        with self.require_parens(operator_precedence, node):
            self.write(operator)
            # factor prefixes (+, -, ~) shouldn't be separated
            # from the value they belong, (e.g: +1 instead of + 1)
            if operator_precedence is not _Precedence.FACTOR:
                self.write(" ")
            self.set_precedence(operator_precedence, node.operand)
            self.traverse(node.operand)

    binop = {
        "Add": "+",
        "Sub": "-",
        "Mult": "*",
        "MatMult": "@",
        "Div": "/",
        "Mod": "%",
        "LShift": "<<",
        "RShift": ">>",
        "BitOr": "|",
        "BitXor": "^",
        "BitAnd": "&",
        "FloorDiv": "//",
        "Pow": "**",
    }

    binop_precedence = {
        "+": _Precedence.ARITH,
        "-": _Precedence.ARITH,
        "*": _Precedence.TERM,
        "@": _Precedence.TERM,
        "/": _Precedence.TERM,
        "%": _Precedence.TERM,
        "<<": _Precedence.SHIFT,
        ">>": _Precedence.SHIFT,
        "|": _Precedence.BOR,
 |  |  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             "^": _Precedence.BXOR,
        "&": _Precedence.BAND,
        "//": _Precedence.TERM,
        "**": _Precedence.POWER,
    }

    binop_rassoc = frozenset(("**",))
    def visit_BinOp(self, node):
        operator = self.binop[node.op.__class__.__name__]
        operator_precedence = self.binop_precedence[operator]
        with self.require_parens(operator_precedence, node):
            if operator in self.binop_rassoc:
                left_precedence = operator_precedence.next()
                right_precedence = operator_precedence
            else:
                left_precedence = operator_precedence
                right_precedence = operator_precedence.next()

            self.set_precedence(left_precedence, node.left)
            self.traverse(node.left)
            self.write(f" {operator} ")
            self.set_precedence(right_precedence, node.right)
            self.traverse(node.right)

    cmpops = {
        "Eq": "==",
        "NotEq": "!=",
        "Lt": "<",
        "LtE": "<=",
        "Gt": ">",
        "GtE": ">=",
        "Is": "is",
        "IsNot": "is not",
        "In": "in",
        "NotIn": "not in",
    }

    def visit_Compare(self, node):
        with self.require_parens(_Precedence.CMP, node):
            self.set_precedence(_Precedence.CMP.next(), node.left, *node.comparators)
            self.traverse(node.left)
            for o, e in zip(node.ops, node.comparators):
                self.write(" " + self.cmpops[o.__class__.__name__] + " ")
                self.traverse(e)

    boolops = {"And": "and", "Or": "or"}
    boolop_precedence = {"and": _Precedence.AND, "or": _Precedence.OR}

    def visit_BoolOp(self, node):
        operator = self.boolops[node.op.__class__.__name__]
        operator_precedence = self.boolop_precedence[operator]

        def increasing_level_traverse(node):
            nonlocal operator_precedence
            operator_precedence = operator_precedence.next()
            self.set_precedence(operator_precedence, node)
            self.traverse(node)

        with self.require_parens(operator_precedence, node):
            s = f" {operator} "
            self.interleave(lambda: self.write(s), increasing_level_traverse, node.values)

    def visit_Attribute(self, node):
        self.set_precedence(_Precedence.ATOM, node.value)
        self.traverse(node.value)
        # Special case: 3.__abs__() is a syntax error, so if node.value
        # is an integer literal then we need to either parenthesize
        # it or add an extra space to get 3 .__abs__().
        if isinstance(node.value, Constant) and isinstance(node.value.value, int):
            self.write(" ")
        self.write(".")
        self.write(node.attr)

    def visit_Call(self, node):
        self.set_precedence(_Precedence.ATOM, node.func)
        self.traverse(node.func)
        with self.delimit("(", ")"):
            comma = False
            for e in node.args:
                if comma:
                    self.write(", ")
                else:
                    comma = True
                self.traverse(e)
            for e in node.keywords:
                if comma:
                    self.write(", ")
                else:
                    comma = True
                self.traverse(e)

    def visit_Subscript(self, node):
        def is_non_empty_tuple(slice_value):
            return (
                isinstance(slice_value, Tuple)
                and slice_value.elts
            )

        self.set_precedence(_Precedence.ATOM, node.value)
        self.traverse(node.value)
        with self.delimit("[", "]"):
            if is_non_empty_tuple(node.slice):
                # parentheses can be omitted if the tuple isn't empty
                self.items_view(self.traverse, node.slice.elts)
            else:
                self.traverse(node.slice)

    def visit_Starred(self, node):
        self.write("*")
        self.set_precedence(_Precedence.EXPR, node.value)
        self.traverse(node.value)

    def visit_Ellipsis(self, node):
        self.write("...")

    def visit_Slice(self, node):
        if node.lower:
            self.traverse(node.lower)
        self.write(":")
        if node.upper:
            self.traverse(node.upper)
        if node.step:
            self.write(":")
            self.traverse(node.step)

    def visit_Match(self, node):
        self.fill("match ")
        self.traverse(node.subject)
        with self.block():
            for case in node.cases:
                self.traverse(case)

    def visit_arg(self, node):
        self.write(node.arg)
        if node.annotation:
            self.write(": ")
            self.traverse(node.annotation)

    def visit_arguments(self, node):
        first = True
        # normal arguments
        all_args = node.posonlyargs + node.args
        defaults = [None] * (len(all_args) - len(node.defaults)) + node.defaults
        for index, elements in enumerate(zip(all_args, defaults), 1):
            a, d = elements
            if first:
                first = False
            else:
                self.write(", ")
            self.traverse(a)
            if d:
                self.write("=")
                self.traverse(d)
            if index == len(node.posonlyargs):
                self.write(", /")

        # varargs, or bare '*' if no varargs but keyword-only arguments present
        if node.vararg or node.kwonlyargs:
            if first:
                first = False
            else:
                self.write(", ")
            self.write("*")
            if node.vararg:
                self.write(node.vararg.arg)
                if node.vararg.annotation:
                    self.write(": ")
                    self.traverse(node.vararg.annotation)

        # keyword-only arguments
        if node.kwonlyargs:
            for a, d in zip(node.kwonlyargs, node.kw_defaults):
                self.write(", ")
                self.traverse(a)
                if d:
                    self.write("=")
                    self.traverse(d)

        # kwargs
        if node.kwarg:
            if first:
                first = False
            else:
                self.write(", ")
            self.write("**" + node.kwarg.arg)
            if node.kwarg.annotation:
                self.write(": ")
                self.traverse(node.kwarg.annotation)

    def visit_keyword(self, node):
        if node.arg is None:
            self.write("**")
        else:
            self.write(node.arg)
            self.write("=")
        self.traverse(node.value)

    def visit_Lambda(self, node):
        with self.require_parens(_Precedence.TEST, node):
            self.write("lambda")
            with self.buffered() as buffer:
                self.traverse(node.args)
            if buffer:
                self.write(" ", *buffer)
            self.write(": ")
            self.set_precedence(_Precedence.TEST, node.body)
            self.traverse(node.body)

    def visit_alias(self, node):
        self.write(node.name)
        if node.asname:
            self.write(" as " + node.asname)

    def visit_withitem(self, node):
        self.traverse(node.context_expr)
        if node.optional_vars:
            self.write(" as ")
            self.traverse(node.optional_vars)

    def visit_match_case(self, node):
        self.fill("case ")
        self.traverse(node.pattern)
        if node.guard:
            self.write(" if ")
            self.traverse(node.guard)
        with self.block():
            self.traverse(node.body)

    def visit_MatchValue(self, node):
        self.traverse(node.value)

    def visit_MatchSingleton(self, node):
        self._write_constant(node.value)

    def visit_MatchSequence(self, node):
        with self.delimit("[", "]"):
            self.interleave(
                lambda: self.write(", "), self.traverse, node.patterns
            )

    def visit_MatchStar(self, node):
        name = node.name
        if name is None:
            name = "_"
        self.write(f"*{name}")

    def visit_MatchMapping(self, node):
        def write_key_pattern_pair(pair):
            k, p = pair
            self.traverse(k)
            self.write(": ")
            self.traverse(p)

        with self.delimit("{", "}"):
            keys = node.keys
            self.interleave(
                lambda: self.write(", "),
                write_key_pattern_pair,
                zip(keys, node.patterns, strict=True),
            )
            rest = node.rest
            if rest is not None:
                if keys:
                    self.write(", ")
                self.write(f"**{rest}")

    def visit_MatchClass(self, node):
        self.set_precedence(_Precedence.ATOM, node.cls)
        self.traverse(node.cls)
        with self.delimit("(", ")"):
            patterns = node.patterns
            self.interleave(
                lambda: self.write(", "), self.traverse, patterns
            )
            attrs = node.kwd_attrs
            if attrs:
                def write_attr_pattern(pair):
                    attr, pattern = pair
                    self.write(f"{attr}=")
                    self.traverse(pattern)

                if patterns:
                    self.write(", ")
                self.interleave(
                    lambda: self.write(", "),
                    write_attr_pattern,
                    zip(attrs, node.kwd_patterns, strict=True),
                )

    def visit_MatchAs(self, node):
        name = node.name
        pattern = node.pattern
        if name is None:
            self.write("_")
        elif pattern is None:
            self.write(node.name)
        else:
            with self.require_parens(_Precedence.TEST, node):
                self.set_precedence(_Precedence.BOR, node.pattern)
                self.traverse(node.pattern)
                self.write(f" as {node.name}")

    def visit_MatchOr(self, node):
        with self.require_parens(_Precedence.BOR, node):
            self.set_precedence(_Precedence.BOR.next(), *node.patterns)
            self.interleave(lambda: self.write(" | "), self.traverse, node.patterns)

def unparse(ast_obj):
    unparser = _Unparser()
    return unparser.visit(ast_obj)


def main():
    import argparse

    parser = argparse.ArgumentParser(prog='python -m ast')
    parser.add_argument('infile', type=argparse.FileType(mode='rb'), nargs='?',
                        default='-',
                        help='the file to parse; defaults to stdin')
    parser.add_argument('-m', '--mode', default='exec',
                        choices=('exec', 'single', 'eval', 'func_type'),
                        help='specify what kind of code must be parsed')
    parser.add_argument('--no-type-comments', default=True, action='store_false',
                        help="don't add information about type comments")
    parser.add_argument('-a', '--include-attributes', action='store_true',
                        help='include attributes such as line numbers and '
                             'column offsets')
    parser.add_argument('-i', '--indent', type=int, default=3,
                        help='indentation of nodes (number of spaces)')
    args = parser.parse_args()

    with args.infile as infile:
        source = infile.read()
    tree = parse(source, args.infile.name, args.mode, type_comments=args.no_type_comments)
    print(dump(tree, include_attributes=args.include_attributes, indent=args.indent))

if __name__ == '__main__':
    main()
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     # -*- Mode: Python; tab-width: 4 -*-
#       Id: asynchat.py,v 2.26 2000/09/07 22:29:26 rushing Exp
#       Author: Sam Rushing <rushing@nightmare.com>

# ======================================================================
# Copyright 1996 by Sam Rushing
#
#                         All Rights Reserved
#
# Permission to use, copy, modify, and distribute this software and
# its documentation for any purpose and without fee is hereby
# granted, provided that the above copyright notice appear in all
# copies and that both that copyright notice and this permission
# notice appear in supporting documentation, and that the name of Sam
# Rushing not be used in advertising or publicity pertaining to
# distribution of the software without specific, written prior
# permission.
#
# SAM RUSHING DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE,
# INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS, IN
# NO EVENT SHALL SAM RUSHING BE LIABLE FOR ANY SPECIAL, INDIRECT OR
# CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
# OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
# NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
# CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
# ======================================================================

r"""A class supporting chat-style (command/response) protocols.

This class adds support for 'chat' style protocols - where one side
sends a 'command', and the other sends a response (examples would be
the common internet protocols - smtp, nntp, ftp, etc..).

The handle_read() method looks at the input stream for the current
'terminator' (usually '\r\n' for single-line responses, '\r\n.\r\n'
for multi-line output), calling self.found_terminator() on its
receipt.

for example:
Say you build an async nntp client using this class.  At the start
of the connection, you'll have self.terminator set to '\r\n', in
order to process the single-line greeting.  Just before issuing a
'LIST' command you'll set it to '\r\n.\r\n'.  The output of the LIST
command will be accumulated (using your own 'collect_incoming_data'
method) up to the terminator, and then control will be returned to
you - by calling your self.found_terminator() method.
"""
import asyncore
from collections import deque

from warnings import _deprecated

_DEPRECATION_MSG = ('The {name} module is deprecated and will be removed in '
                    'Python {remove}. The recommended replacement is asyncio')
_deprecated(__name__, _DEPRECATION_MSG, remove=(3, 12))



class async_chat(asyncore.dispatcher):
    """This is an abstract class.  You must derive from this class, and add
    the two methods collect_incoming_data() and found_terminator()"""

    # these are overridable defaults

    ac_in_buffer_size = 65536
    ac_out_buffer_size = 65536

    # we don't want to enable the use of encoding by default, because that is a
    # sign of an application bug that we don't want to pass silently

    use_encoding = 0
    encoding = 'latin-1'

    def __init__(self, sock=None, map=None):
        # for string terminator matching
        self.ac_in_buffer = b''

        # we use a list here rather than io.BytesIO for a few reasons...
        # del lst[:] is faster than bio.truncate(0)
        # lst = [] is faster than bio.truncate(0)
        self.incoming = []

        # we toss the use of the "simple producer" and replace it with
        # a pure deque, which the original fifo was a wrapping of
        self.producer_fifo = deque()
        asyncore.dispatcher.__init__(self, sock, map)

    def collect_incoming_data(self, data):
        raise NotImplementedError("must be implemented in subclass")

    def _collect_incoming_data(self, data):
        self.incoming.append(data)

    def _get_data(self):
        d = b''.join(self.incoming)
        del self.incoming[:]
        return d

    def found_terminator(self):
        raise NotImplementedError("must be implemented in subclass")

    def set_terminator(self, term):
        """Set the input delimiter.

        Can be a fixed string of any length, an integer, or None.
        """
        if isinstance(term, str) and self.use_encoding:
            term = bytes(term, self.encoding)
        elif isinstance(term, int) and term < 0:
            raise ValueError('the number of received bytes must be positive')
        self.terminator = term

    def get_terminator(self):
        return self.terminator

    # grab some more data from the socket,
    # throw it to the collector method,
    # check for the terminator,
    # if found, transition to the next state.

    def handle_read(self):

        try:
            data = self.recv(self.ac_in_buffer_size)
        except BlockingIOError:
            return
        except OSError:
            self.handle_error()
            return

        if isinstance(data, str) and self.use_encoding:
            data = bytes(str, self.encoding)
        self.ac_in_buffer = self.ac_in_buffer + data

        # Continue to search for self.terminator in self.ac_in_buffer,
        # while calling self.collect_incoming_data.  The while loop
        # is necessary because we might read several data+terminator
        # combos with a single recv(4096).

        while self.ac_in_buffer:
            lb = len(self.ac_in_buffer)
            terminator = self.get_terminator()
            if not terminator:
                # no terminator, collect it all
                self.collect_incoming_data(self.ac_in_buffer)
                self.ac_in_buffer = b''
            elif isinstance(terminator, int):
                # numeric terminator
                n = terminator
                if lb < n:
                    self.collect_incoming_data(self.ac_in_buffer)
                    self.ac_in_buffer = b''
                    self.terminator = self.terminator - lb
                else:
                    self.collect_incoming_data(self.ac_in_buffer[:n])
                    self.ac_in_buffer = self.ac_in_buffer[n:]
                    self.terminator = 0
                    self.found_terminator()
            else:
                # 3 cases:
                # 1) end of buffer matches terminator exactly:
                #    collect data, transition
                # 2) end of buffer matches some prefix:
                #    collect data to the prefix
                # 3) end of buffer does not match any prefix:
                #    collect data
                terminator_len = len(terminator)
                index = self.ac_in_buffer.find(terminator)
                if index != -1:
                    # we found the terminator
                    if index > 0:
                        # don't bother reporting the empty string
                        # (source of subtle bugs)
                        self.collect_incoming_data(self.ac_in_buffer[:index])
                    self.ac_in_buffer = self.ac_in_buffer[index+terminator_len:]
                    # This does the Right Thing if the terminator
                    # is changed here.
                    self.found_terminator()
                else:
                    # check for a prefix of the terminator
                    index = find_prefix_at_end(self.ac_in_buffer, terminator)
                    if index:
                        if index != lb:
                            # we found a prefix, collect up to the prefix
                            self.collect_incoming_data(self.ac_in_buffer[:-index])
                            self.ac_in_buffer = self.ac_in_buffer[-index:]
                        break
                    else:
                        # no prefix, collect it all
                        self.collect_incoming_data(self.ac_in_buffer)
                        self.ac_in_buffer = b''

    def handle_write(self):
        self.initiate_send()

    def handle_close(self):
        self.close()

    def push(self, data):
        if not isinstance(data, (bytes, bytearray, memoryview)):
            raise TypeError('data argument must be byte-ish (%r)',
                            type(data))
        sabs = self.ac_out_buffer_size
        if len(data) > sabs:
            for i in range(0, len(data), sabs):
                self.producer_fifo.append(data[i:i+sabs])
        else:
            self.producer_fifo.append(data)
        self.initiate_send()

    def push_with_producer(self, producer):
        self.producer_fifo.append(producer)
        self.initiate_send()

    def readable(self):
        "predicate for inclusion in the readable for select()"
        # cannot use the old predicate, it violates the claim of the
        # set_terminator method.

        # return (len(self.ac_in_buffer) <= self.ac_in_buffer_size)
        return 1

    def writable(self):
        "predicate for inclusion in the writable for select()"
        return self.producer_fifo or (not self.connected)

    def close_when_done(self):
        "automatically close this channel once the outgoing queue is empty"
        self.producer_fifo.append(None)

    def initiate_send(self):
        while self.producer_fifo and self.connected:
            first = self.producer_fifo[0]
            # handle empty string/buffer or None entry
            if not first:
                del self.producer_fifo[0]
                if first is None:
                    self.handle_close()
                    return

            # handle classic producer behavior
            obs = self.ac_out_buffer_size
            try:
                data = first[:obs]
            except TypeError:
                data = first.more()
                if data:
                    self.producer_fifo.appendleft(data)
                else:
                    del self.producer_fifo[0]
                continue

            if isinstance(data, str) and self.use_encoding:
                data = bytes(data, self.encoding)

            # send the data
            try:
                num_sent = self.send(data)
            except OSError:
                self.handle_error()
                return

            if num_sent:
                if num_sent < len(data) or obs < len(first):
                    self.producer_fifo[0] = first[num_sent:]
                else:
                    del self.producer_fifo[0]
            # we tried to send some actual data
            return

    def discard_buffers(self):
        # Emergencies only!
        self.ac_in_buffer = b''
        del self.incoming[:]
        self.producer_fifo.clear()


class simple_producer:

    def __init__(self, data, buffer_size=512):
        self.data = data
        self.buffer_size = buffer_size

    def more(self):
        if len(self.data) > self.buffer_size:
            result = self.data[:self.buffer_size]
            self.data = self.data[self.buffer_size:]
            return result
        else:
            result = self.data
            self.data = b''
            return result


# Given 'haystack', see if any prefix of 'needle' is at its end.  This
# assumes an exact match has already been checked.  Return the number of
# characters matched.
# for example:
# f_p_a_e("qwerty\r", "\r\n") => 1
# f_p_a_e("qwertydkjf", "\r\n") => 0
# f_p_a_e("qwerty\r\n", "\r\n") => <undefined>

# this could maybe be made faster with a computed regex?
# [answer: no; circa Python-2.0, Jan 2001]
# new python:   28961/s
# old python:   18307/s
# re:        12820/s
# regex:     14035/s

def find_prefix_at_end(haystack, needle):
    l = len(needle) - 1
    while l and not haystack.endswith(needle[:l]):
        l -= 1
    return l
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ã	   .   Ω   ..  å	   __init__.py ç	   __main__.py é	   __pycache__ ∞	   base_events.py  ±	   base_futures.py ≤	   base_subprocess.py  ≥	   base_tasks.py   ¥	   constants.pyµ	   coroutines.py   ∂	   	events.py   ∑	   exceptions.py   ∏	   format_helpers.py   π	   
futures.py  ∫	   locks.pyª	   log.py  º	   	mixins.py   Ω	   proactor_events.py  æ	   protocols.pyø	   	queues.py   ¿	   
runners.py  ¡	   selector_events.py  ¬	   sslproto.py √	   staggered.pyƒ	   
streams.py  ≈	   subprocess.py   ∆	   taskgroups.py   «	   tasks.py»	   
threads.py  …	   timeouts.py  	   transports.py   À	   	trsock.py   Ã	   unix_events.py  Õ	   windows_events.py   Œ	  windows_utils.py                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            """The asyncio package, tracking PEP 3156."""

# flake8: noqa

import sys

# This relies on each of the submodules having an __all__ variable.
from .base_events import *
from .coroutines import *
from .events import *
from .exceptions import *
from .futures import *
from .locks import *
from .protocols import *
from .runners import *
from .queues import *
from .streams import *
from .subprocess import *
from .tasks import *
from .taskgroups import *
from .timeouts import *
from .threads import *
from .transports import *

__all__ = (base_events.__all__ +
           coroutines.__all__ +
           events.__all__ +
           exceptions.__all__ +
           futures.__all__ +
           locks.__all__ +
           protocols.__all__ +
           runners.__all__ +
           queues.__all__ +
           streams.__all__ +
           subprocess.__all__ +
           tasks.__all__ +
           threads.__all__ +
           timeouts.__all__ +
           transports.__all__)

if sys.platform == 'win32':  # pragma: no cover
    from .windows_events import *
    __all__ += windows_events.__all__
else:
    from .unix_events import *  # pragma: no cover
    __all__ += unix_events.__all__
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            import ast
import asyncio
import code
import concurrent.futures
import inspect
import sys
import threading
import types
import warnings

from . import futures


class AsyncIOInteractiveConsole(code.InteractiveConsole):

    def __init__(self, locals, loop):
        super().__init__(locals)
        self.compile.compiler.flags |= ast.PyCF_ALLOW_TOP_LEVEL_AWAIT

        self.loop = loop

    def runcode(self, code):
        future = concurrent.futures.Future()

        def callback():
            global repl_future
            global repl_future_interrupted

            repl_future = None
            repl_future_interrupted = False

            func = types.FunctionType(code, self.locals)
            try:
                coro = func()
            except SystemExit:
                raise
            except KeyboardInterrupt as ex:
                repl_future_interrupted = True
                future.set_exception(ex)
                return
            except BaseException as ex:
                future.set_exception(ex)
                return

            if not inspect.iscoroutine(coro):
                future.set_result(coro)
                return

            try:
                repl_future = self.loop.create_task(coro)
                futures._chain_future(repl_future, future)
            except BaseException as exc:
                future.set_exception(exc)

        loop.call_soon_threadsafe(callback)

        try:
            return future.result()
        except SystemExit:
            raise
        except BaseException:
            if repl_future_interrupted:
                self.write("\nKeyboardInterrupt\n")
            else:
                self.showtraceback()


class REPLThread(threading.Thread):

    def run(self):
        try:
            banner = (
                f'asyncio REPL {sys.version} on {sys.platform}\n'
                f'Use "await" directly instead of "asyncio.run()".\n'
                f'Type "help", "copyright", "credits" or "license" '
                f'for more information.\n'
                f'{getattr(sys, "ps1", ">>> ")}import asyncio'
            )

            console.interact(
                banner=banner,
                exitmsg='exiting asyncio REPL...')
        finally:
            warnings.filterwarnings(
                'ignore',
                message=r'^coroutine .* was never awaited$',
                category=RuntimeWarning)

            loop.call_soon_threadsafe(loop.stop)


if __name__ == '__main__':
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)

    repl_locals = {'asyncio': asyncio}
    for key in {'__name__', '__package__',
                '__loader__', '__spec__',
                '__builtins__', '__file__'}:
        repl_locals[key] = locals()[key]

    console = AsyncIOInteractiveConsole(repl_locals, loop)

    repl_future = None
    repl_future_interrupted = False

    try:
        import readline  # NoQA
    except ImportError:
        pass

    repl_thread = REPLThread()
    repl_thread.daemon = True
    repl_thread.start()

    while True:
        try:
            loop.run_forever()
        except KeyboardInterrupt:
            if repl_future and not repl_future.done():
                repl_future.cancel()
                repl_future_interrupted = True
            continue
        else:
            break
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 é	   .   ã	   ..  è	    __init__.cpython-311.pycê	    __main__.cpython-311.pycë	  $ base_events.cpython-311.pyc í	  $ base_futures.cpython-311.pycì	  ( base_subprocess.cpython-311.pyc î	  $ base_tasks.cpython-311.pyc  ï	  $ constants.cpython-311.pyc   ñ	  $ coroutines.cpython-311.pyc  ó	    events.cpython-311.pyc  ò	  $ exceptions.cpython-311.pyc  ô	  ( format_helpers.cpython-311.pyc  ö	    futures.cpython-311.pyc õ	    locks.cpython-311.pyc   ú	   log.cpython-311.pyc ù	    mixins.cpython-311.pyc  û	  ( proactor_events.cpython-311.pyc ü	  $ protocols.cpython-311.pyc   †	    queues.cpython-311.pyc  °	    runners.cpython-311.pyc ¢	  ( selector_events.cpython-311.pyc £	    sslproto.cpython-311.pyc§	  $ staggered.cpython-311.pyc   •	    streams.cpython-311.pyc ¶	  $ subprocess.cpython-311.pyc  ß	  $ taskgroups.cpython-311.pyc  ®	    tasks.cpython-311.pyc   ©	    threads.cpython-311.pyc ™	    timeouts.cpython-311.pyc´	  $ transports.cpython-311.pyc  ¨	    trsock.cpython-311.pyc  ≠	  $ unix_events.cpython-311.pyc Æ	  ( windows_events.cpython-311.pyc  Ø	  îwindows_utils.cpython-311.pyc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ß
    §åh§  „                   Û“  ó d Z ddlZddlT ddlT ddlT ddlT ddlT ddlT ddlT ddl	T ddl
T ddlT ddlT ddlT ddlT ddlT ddlT ddlT ej        ej        z   ej        z   ej        z   ej        z   ej        z   ej        z   e	j        z   e
j        z   ej        z   ej        z   ej        z   ej        z   ej        z   ej        z   Zej        dk    rddlT eej        z  ZdS ddlT eej        z  ZdS )z'The asyncio package, tracking PEP 3156.È    NÈ   )⁄*⁄win32)⁄__doc__⁄sys⁄base_events⁄
coroutines⁄events⁄
exceptions⁄futures⁄locks⁄	protocols⁄runners⁄queues⁄streams⁄
subprocess⁄tasks⁄
taskgroups⁄timeouts⁄threads⁄
transports⁄__all__⁄platform⁄windows_events⁄unix_events© Û    ˙'/usr/lib/python3.11/asyncio/__init__.py˙<module>r      s”  ÿ -– - Ä
Ä
Ä
 – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ÿ – – – ‡‘ÿ‘Ò‡å>Ò ‘Ò å?Ò	
 å=Ò ‘Ò å?Ò å>Ò å?Ò	 ‘Ò
 å=Ò å?Ò ‘Ò ‘ÒÄ  Ñ<ê7“–ÿ!–!–!–!ÿà~‘%—%ÄGÄGÄG‡–––ÿà{‘"—"ÄGÄGÄGr                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ß
    §åh  „                   Ûp  ó d dl Z d dlZd dlZd dlZd dlZd dlZd dlZd dlZd dl	Z	ddl
mZ  G dÑ dej        ¶  ´        Z G dÑ dej        ¶  ´        Zedk    rﬂ ej        ¶   ´         Z ej        e¶  ´         d	eiZd
D ]Z e¶   ´         e         ee<   å eee¶  ´        Zdada	 d dlZn# e$ r Y nw xY w e¶   ´         Zde_        e†                    ¶   ´          	 	 e†                    ¶   ´          dS # e $ r> t0          r4t0          †!                    ¶   ´         st0          †"                    ¶   ´          daY åZw xY wdS )È    NÈ   )⁄futuresc                   Û$   á ó e Zd Zà fdÑZdÑ Zà xZS )⁄AsyncIOInteractiveConsolec                 Û†   ïó t          ¶   ´         †                    |¶  ´         | j        j        xj        t
          j        z  c_        || _        d S )N)⁄super⁄__init__⁄compile⁄compiler⁄flags⁄ast⁄PyCF_ALLOW_TOP_LEVEL_AWAIT⁄loop)⁄self⁄localsr   ⁄	__class__s      Ä˙'/usr/lib/python3.11/asyncio/__main__.pyr	   z"AsyncIOInteractiveConsole.__init__   sB   ¯Ä ›âå◊“ò— ‘ – ÿå‘–#‘#•s‘'E—E–#‘#‡àå	à	à	Û    c                 ÛL  á ááó t           j        †                    ¶   ´         äààà fdÑ}t          †                    |¶  ´         	 â†                    ¶   ´         S # t          $ r Ç t          $ r7 t          râ †	                    d¶  ´         Y d S â †
                    ¶   ´          Y d S w xY w)Nc                  Û8  ïó d a dat          j        ââj        ¶  ´        } 	  | ¶   ´         }na# t
          $ r Ç t          $ r"}daâ†                    |¶  ´         Y d }~d S d }~wt          $ r }â†                    |¶  ´         Y d }~d S d }~ww xY wt          j
        |¶  ´        sâ†                    |¶  ´         d S 	 âj        †                    |¶  ´        a t          j        t           â¶  ´         d S # t          $ r }â†                    |¶  ´         Y d }~d S d }~ww xY w)NFT)⁄repl_future⁄repl_future_interrupted⁄types⁄FunctionTyper   ⁄
SystemExit⁄KeyboardInterrupt⁄set_exception⁄BaseException⁄inspect⁄iscoroutine⁄
set_resultr   ⁄create_taskr   ⁄_chain_future)⁄func⁄coro⁄ex⁄exc⁄code⁄futurer   s       ÄÄÄr   ⁄callbackz3AsyncIOInteractiveConsole.runcode.<locals>.callback   sn  ¯Ä  àKÿ&+–#Â‘%†d®D¨K—8‘8àD
ÿêtëvîvêê¯›   ÿ›$   ÿ*.–'ÿ◊$“$†R—(‘(–(ÿêêêêê¯¯¯¯›    ÿ◊$“$†R—(‘(–(ÿêêêêê¯¯¯¯¯¯¯ı ‘&†t—,‘, ÿ◊!“!†$—'‘'–'ÿê*ÿ"úi◊3“3∞D—9‘9ê›‘%•k∞6—:‘:–:–:–:¯›  * * *ÿ◊$“$†S—)‘)–)–)–)–)–)–)–)¯¯¯¯*¯¯¯s9   °
, ¨B
¡ A¡B
¡*B¬B
¬94C/ √/
D√9DƒDz
KeyboardInterrupt
)⁄
concurrentr   ⁄Futurer   ⁄call_soon_threadsafe⁄resultr   r   r   ⁄write⁄showtraceback)r   r(   r*   r)   s   `` @r   ⁄runcodez!AsyncIOInteractiveConsole.runcode   s‘   ¯¯¯Ä ›‘#◊*“*—,‘,à	* 	* 	* 	* 	* 	* 	*ı< 	◊!“!†(—+‘+–+	%ÿó=í=ë?î?–"¯› 	 	 	ÿ› 	% 	% 	%›& %ÿó
í
–2—3‘3–3–3–3–3‡◊"“"—$‘$–$–$–$–$		%¯¯¯s   ¡A ¡0B#¬B#¬"B#)⁄__name__⁄
__module__⁄__qualname__r	   r1   ⁄__classcell__)r   s   @r   r   r      sG   ¯Ä Ä Ä Ä Ä     +% +% +% +% +% +% +%r   r   c                   Û   ó e Zd ZdÑ ZdS )⁄
REPLThreadc           
      Û≤  ó 	 dt           j        õ dt           j        õ dt          t           dd¶  ´        õ dù}t          †                    |d¨¶  ´         t          j        d	d
t          ¨¶  ´         t          †
                    t          j        ¶  ´         d S # t          j        d	d
t          ¨¶  ´         t          †
                    t          j        ¶  ´         w xY w)Nzasyncio REPL z on zy
Use "await" directly instead of "asyncio.run()".
Type "help", "copyright", "credits" or "license" for more information.
⁄ps1z>>> zimport asynciozexiting asyncio REPL...)⁄banner⁄exitmsg⁄ignorez ^coroutine .* was never awaited$)⁄message⁄category)⁄sys⁄version⁄platform⁄getattr⁄console⁄interact⁄warnings⁄filterwarnings⁄RuntimeWarningr   r-   ⁄stop)r   r:   s     r   ⁄runzREPLThread.runF   s˘   Ä 	1?•§ ? ?µ¥ ? ?ı ù3††v—.‘.	? ? ? ı ◊“ÿÿ1 Ò 3Ù 3 3ı ‘#ÿÿ;›')Ò )Ù ) )ı
 ◊%“%•d§i—0‘0–0–0–0¯ı ‘#ÿÿ;›')Ò )Ù ) )ı
 ◊%“%•d§i—0‘0–0–0¯¯¯s   ÇAB ¬ACN)r2   r3   r4   rI   © r   r   r7   r7   D   s#   Ä Ä Ä Ä Ä 1 1 1 1 1r   r7   ⁄__main__⁄asyncio>   ⁄__file__r2   ⁄__spec__⁄
__loader__⁄__package__⁄__builtins__FT)#r   rL   r(   ⁄concurrent.futuresr+   r   r?   ⁄	threadingr   rE   ⁄ r   ⁄InteractiveConsoler   ⁄Threadr7   r2   ⁄new_event_loopr   ⁄set_event_loop⁄repl_locals⁄keyr   rC   r   r   ⁄readline⁄ImportError⁄repl_thread⁄daemon⁄start⁄run_foreverr   ⁄done⁄cancelrJ   r   r   ˙<module>rc      s!  ÿ 
Ä
Ä
Ä
ÿ ÄÄÄÿ ÄÄÄÿ – – – ÿ ÄÄÄÿ 
Ä
Ä
Ä
ÿ – – – ÿ ÄÄÄÿ ÄÄÄ‡ – – – – – 3% 3% 3% 3% 3%†‘ 7Ò 3%Ù 3% 3%l1 1 1 1 1ê‘!Ò 1Ù 1 10 àz“–ÿ!à7‘!—#‘#ÄDÿÄG‘ò4— ‘ – ‡òg–&ÄK, ) )à "ò6ô8ú8†Cú=àêC—–‡'–'®∞T—:‘:ÄG‡ÄKÿ#–ÿàààà¯ÿ   ÿà¯¯¯ ê*ë,î,ÄKÿÄK‘ÿ◊“—‘–		ÿ◊“—‘– àE¯ ! 	 	 	› /•;◊#3“#3—#5‘#5 /›◊"“"—$‘$–$ÿ*.–'ÿàH		¯¯¯7 –s%   ¬#B( ¬(B0¬/B0√C0 √0A D3ƒ2D3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ß
    §åh:$ „                   Û.  ó d Z ddlZddlZddlZddlZddlZddlZddlZddl	Z	ddl
Z
ddlZddlZddlZddlZddlZddlZddlZ	 ddlZn# e$ r dZY nw xY wddlmZ ddlmZ ddlmZ ddlmZ ddlmZ dd	lmZ dd
lmZ ddlmZ ddlmZ ddlmZ ddlmZ ddl m!Z! dZ"dZ#dZ$ e%e	d¶  ´        Z&dZ'dÑ Z(dÑ Z)dÑ Z*d%dÑZ+d&dÑZ,dÑ Z- e%e	d¶  ´        rdÑ Z.ndÑ Z.dÑ Z/ G dÑ d ej0        ¶  ´        Z1 G d!Ñ d"ej2        ¶  ´        Z3 G d#Ñ d$ej4        ¶  ´        Z5dS )'aô  Base implementation of event loop.

The event loop can be broken up into a multiplexer (the part
responsible for notifying us of I/O events) and the event loop proper,
which wraps a multiplexer with functionality for scheduling callbacks,
immediately or at a given time in the future.

Whenever a public API takes a callback, subsequent positional
arguments will be passed to the callback if/when it is called.  This
avoids the proliferation of trivial lambdas implementing closures.
Keyword arguments for the callback are not supported; this is a
conscious design decision, leaving the door open for keyword arguments
to modify the meaning of the API call itself.
È    NÈ   )⁄	constants)⁄
coroutines)⁄events)⁄
exceptions)⁄futures)⁄	protocols)⁄sslproto)⁄	staggered)⁄tasks)⁄
transports)⁄trsock)⁄logger)⁄BaseEventLoop⁄ServerÈd   g      ‡?⁄AF_INET6iÄQ c                 Û®   ó | j         }t          t          |dd ¶  ´        t          j        ¶  ´        rt          |j        ¶  ´        S t          | ¶  ´        S )N⁄__self__)⁄	_callback⁄
isinstance⁄getattrr   ⁄Task⁄reprr   ⁄str)⁄handle⁄cbs     ˙*/usr/lib/python3.11/asyncio/base_events.py⁄_format_handler   F   sF   Ä ÿ	‘	ÄB›ï'ò"òj®$—/‘/µ¥—<‘< ÂêBîK— ‘ – Âê6â{å{–Û    c                 Ûh   ó | t           j        k    rdS | t           j        k    rdS t          | ¶  ´        S )Nz<pipe>z<stdout>)⁄
subprocess⁄PIPE⁄STDOUTr   )⁄fds    r   ⁄_format_piper&   O   s2   Ä ÿ	çZå_“–ÿàxÿ	çz‘ “	 –	 ÿàzÂêBâxåxàr    c                 Û‡   ó t          t          d¶  ´        st          d¶  ´        Ç	 | †                    t          j        t          j        d¶  ´         d S # t          $ r t          d¶  ´        Çw xY w)N⁄SO_REUSEPORTz)reuse_port not supported by socket moduler   zTreuse_port not supported by socket module, SO_REUSEPORT defined but not implemented.)⁄hasattr⁄socket⁄
ValueError⁄
setsockopt⁄
SOL_SOCKETr(   ⁄OSError©⁄socks    r   ⁄_set_reuseportr1   X   sÜ   Ä ›ï6ò>—*‘* J›–D—E‘E–E	JÿèOäOùF‘-≠v‘/B¿A—F‘F–F–F–F¯› 	J 	J 	J› IÒ JÙ J J	J¯¯¯s   ¶+A ¡A-c           	      Û^  ó t          t          d¶  ´        sd S |dt          j        t          j        hvs| Äd S |t          j        k    rt          j        }n|t          j        k    rt          j        }nd S |Äd}net          |t          ¶  ´        r	|dk    rd}nGt          |t          ¶  ´        r	|dk    rd}n)	 t          |¶  ´        }n# t          t          f$ r Y d S w xY w|t          j        k    r4t          j        g}t          r|†                    t          j        ¶  ´         n|g}t          | t          ¶  ´        r| †                    d¶  ´        } d| v rd S |D ]V}	 t          j        || ¶  ´         t          r|t          j        k    r|||d| |||ffc S |||d| |ffc S # t&          $ r Y åSw xY wd S )N⁄	inet_ptonr   r    ⁄ ⁄idna˙%)r)   r*   ⁄IPPROTO_TCP⁄IPPROTO_UDP⁄SOCK_STREAM⁄
SOCK_DGRAMr   ⁄bytesr   ⁄int⁄	TypeErrorr+   ⁄	AF_UNSPEC⁄AF_INET⁄	_HAS_IPv6⁄appendr   ⁄decoder3   r.   )	⁄host⁄port⁄family⁄type⁄proto⁄flowinfo⁄scopeid⁄afs⁄afs	            r   ⁄_ipaddr_inforL   c   s  Ä ı ï6ò;—'‘' ÿà‡êQù‘*≠F‘,>–?–?–?ÿàLÿàt‡çv‘!“!–!›‘"ààÿ	ï‘"“	"–	"›‘"àà‡àt‡Ä|ÿàà›	êDù%—	 ‘	  	†T®S¢[†[ÿàà›	êDù#—	‘	 †4®2¢:†:ÿàà	›êtë9î9àDàD¯›ù:–& 	 	 	ÿê4ê4	¯¯¯ ï‘!“!–!›å~–à› 	(ÿèJäJïvî—'‘'–'¯‡àhàÂê$ù—‘ #ÿè{ä{ò6—"‘"àÿ
àdÄ{Ä{ àt‡ 	 	à	›‘òR†—&‘&–&Â 9òR•6§?“2–2ÿò4†®®T∞4∏¿7–,K–K–K–K–K‡ò4†®®T∞4®L–8–8–8–8¯› 	 	 	ÿàD	¯¯¯ à4s*   ¬5C √C√C≈6F∆F∆
F*∆)F*c                 Ûÿ  ó t          j        ¶   ´         }| D ].}|d         }||vrg ||<   ||         †                    |¶  ´         å/t          |†                    ¶   ´         ¶  ´        }g }|dk    r4|†                    |d         d|dz
  Ö         ¶  ´         |d         d|dz
  Ö= |†                    dÑ t          j        †                    t          j	        |é ¶  ´        D ¶   ´         ¶  ´         |S )z-Interleave list of addrinfo tuples by family.r   r   Nc              3   Û   K  ó | ]}|Æ|V ó å	d S ©N© )⁄.0⁄as     r   ˙	<genexpr>z(_interleave_addrinfos.<locals>.<genexpr>≠   s0   Ë Ë Ä   ÿ‡à] 	
‡à]à]à] r    )
⁄collections⁄OrderedDictrA   ⁄list⁄values⁄extend⁄	itertools⁄chain⁄from_iterable⁄zip_longest)⁄	addrinfos⁄first_address_family_count⁄addrinfos_by_family⁄addrrE   ⁄addrinfos_lists⁄	reordereds          r   ⁄_interleave_addrinfosrc   û   s$  Ä ı &‘1—3‘3–ÿ 1 1àÿêaîàÿ–,–,–,ÿ*,–†—'ÿòF‘#◊*“*®4—0‘0–0–0›–.◊5“5—7‘7—8‘8ÄO‡ÄIÿ!†A“%–%ÿ◊“ò®‘+–,K–-G»!—-K–,K‘L—M‘M–MÿòA‘–>– :∏Q— >–>–?ÿ◊“  ›î?◊0“0›‘!†?–3Ò
Ù 
Ò Ù Ò Ù   –r    c                 Ûﬁ   ó | †                     ¶   ´         s2| †                    ¶   ´         }t          |t          t          f¶  ´        rd S t          j        | ¶  ´        †                    ¶   ´          d S rO   )⁄	cancelled⁄	exceptionr   ⁄
SystemExit⁄KeyboardInterruptr   ⁄	_get_loop⁄stop)⁄fut⁄excs     r   ⁄_run_until_complete_cbrm   ¥   sa   Ä ÿè=ä=â?å? ÿèmämâoåoà›êcùJ’(9–:—;‘; 	 àF›‘êc—‘◊“—!‘!–!–!–!r    ⁄TCP_NODELAYc                 Û˙   ó | j         t          j        t          j        hv rW| j        t          j        k    rD| j        t          j        k    r1| †                    t          j        t          j	        d¶  ´         d S d S d S d S ©Nr   )
rE   r*   r?   r   rF   r9   rG   r7   r,   rn   r/   s    r   ⁄_set_nodelayrq   ø   sn   Ä ÿåKùFúN≠F¨O–<–<–<ÿî	ùV‘/“/–/ÿî
ùf‘0“0–0ÿèOäOùF‘.µ‘0B¿A—F‘F–F–F–F =–<ÿ/–/ÿ0–0r    c                 Û   ó d S rO   rP   r/   s    r   rq   rq   ≈   s   Ä ÿàr    c                 Ûj   ó t           Å)t          | t           j        ¶  ´        rt          d¶  ´        Çd S d S )Nz"Socket cannot be of type SSLSocket)⁄sslr   ⁄	SSLSocketr=   r/   s    r   ⁄_check_ssl_socketrv   …   s1   Ä ›
Äù:†d≠C¨M—:‘:Ä›–<—=‘=–= ÄÄÄr    c                   ÛD   ó e Zd ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ Z	dÑ Z
d	Ñ Zd
S )⁄_SendfileFallbackProtocolc                 Ûö  ó t          |t          j        ¶  ´        st          d¶  ´        Ç|| _        |†                    ¶   ´         | _        |†                    ¶   ´         | _        |j	        | _
        |†                    ¶   ´          |†                    | ¶  ´         | j
        r%| j        j        †                    ¶   ´         | _        d S d | _        d S )Nz.transport should be _FlowControlMixin instance)r   r   ⁄_FlowControlMixinr=   ⁄
_transport⁄get_protocol⁄_proto⁄
is_reading⁄_should_resume_reading⁄_protocol_paused⁄_should_resume_writing⁄pause_reading⁄set_protocol⁄_loop⁄create_future⁄_write_ready_fut)⁄self⁄transps     r   ⁄__init__z"_SendfileFallbackProtocol.__init__œ   sæ   Ä ›ò&•*‘">—?‘? 	N›–L—M‘M–Mÿ àåÿ◊)“)—+‘+àåÿ&,◊&7“&7—&9‘&9à‘#ÿ&,‘&=à‘#ÿ◊“—‘–ÿ◊“òD—!‘!–!ÿ‘& 	)ÿ$(§O‘$9◊$G“$G—$I‘$IàD‘!–!–!‡$(àD‘!–!–!r    c              É   ÛÄ   K  ó | j         †                    ¶   ´         rt          d¶  ´        Ç| j        }|Äd S |É d {V óÜ d S )NzConnection closed by peer)r{   ⁄
is_closing⁄ConnectionErrorrÜ   )rá   rk   s     r   ⁄drainz_SendfileFallbackProtocol.drain›   sR   Ë Ë Ä ÿå?◊%“%—'‘' 	?›!–"=—>‘>–>ÿ‘#àÿà;ÿàFÿà	à	à	à	à	à	à	à	à	r    c                 Û    ó t          d¶  ´        Ç)Nz?Invalid state: connection should have been established already.©⁄RuntimeError)rá   ⁄	transports     r   ⁄connection_madez)_SendfileFallbackProtocol.connection_madeÂ   s   Ä › NÒ OÙ O 	Or    c                 Û–   ó | j         ÅD|Ä(| j         †                    t          d¶  ´        ¶  ´         n| j         †                    |¶  ´         | j        †                    |¶  ´         d S )NzConnection is closed by peer)rÜ   ⁄set_exceptionrå   r}   ⁄connection_lost)rá   rl   s     r   rï   z)_SendfileFallbackProtocol.connection_lostÈ   sw   Ä ÿ‘ –, à{ÿ‘%◊3“3›#–$B—C‘CÒEÙ E E E ‘%◊3“3∞C—8‘8–8ÿå◊#“#†C—(‘(–(–(–(r    c                 Û^   ó | j         Åd S | j        j        †                    ¶   ´         | _         d S rO   )rÜ   r{   rÑ   rÖ   ©rá   s    r   ⁄pause_writingz'_SendfileFallbackProtocol.pause_writingÙ   s/   Ä ÿ‘ –,ÿàFÿ $§‘ 5◊ C“ C— E‘ Eà‘––r    c                 ÛZ   ó | j         Äd S | j         †                    d¶  ´         d | _         d S )NF)rÜ   ⁄
set_resultró   s    r   ⁄resume_writingz(_SendfileFallbackProtocol.resume_writing˘   s5   Ä ÿ‘ –(ÿàFÿ‘◊(“(®—/‘/–/ÿ $à‘––r    c                 Û    ó t          d¶  ´        Ç©Nz'Invalid state: reading should be pausedrè   )rá   ⁄datas     r   ⁄data_receivedz'_SendfileFallbackProtocol.data_receivedˇ   Û   Ä ›–D—E‘E–Er    c                 Û    ó t          d¶  ´        Çrù   rè   ró   s    r   ⁄eof_receivedz&_SendfileFallbackProtocol.eof_received  r†   r    c              É   Û  K  ó | j         †                    | j        ¶  ´         | j        r| j         †                    ¶   ´          | j        Å| j        †                    ¶   ´          | j        r| j        †                    ¶   ´          d S d S rO   )	r{   rÉ   r}   r   ⁄resume_readingrÜ   ⁄cancelrÅ   rõ   ró   s    r   ⁄restorez!_SendfileFallbackProtocol.restore  så   Ë Ë Ä ÿå◊$“$†T§[—1‘1–1ÿ‘& 	-ÿåO◊*“*—,‘,–,ÿ‘ –, ‘!◊(“(—*‘*–*ÿ‘& 	)ÿåK◊&“&—(‘(–(–(–(	) 	)r    N)⁄__name__⁄
__module__⁄__qualname__râ   rç   rí   rï   rò   rõ   rü   r¢   r¶   rP   r    r   rx   rx   Œ   sß   Ä Ä Ä Ä Ä ) ) )  O O O	) 	) 	)F F F
% % %F F FF F F
) 
) 
) 
) 
)r    rx   c                   Ûp   ó e Zd Z	 ddÑZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ Z	d	Ñ Z
ed
Ñ ¶   ´         ZdÑ ZdÑ ZdÑ ZdÑ ZdS )r   Nc                 Û†   ó || _         || _        d| _        g | _        || _        || _        || _        || _        || _        d| _	        d | _
        d S )Nr   F)rÑ   ⁄_sockets⁄_active_count⁄_waiters⁄_protocol_factory⁄_backlog⁄_ssl_context⁄_ssl_handshake_timeout⁄_ssl_shutdown_timeout⁄_serving⁄_serving_forever_fut)rá   ⁄loop⁄sockets⁄protocol_factory⁄ssl_context⁄backlog⁄ssl_handshake_timeout⁄ssl_shutdown_timeouts           r   râ   zServer.__init__  s[   Ä ‡àå
ÿàåÿà‘ÿàåÿ!1à‘ÿàåÿ'à‘ÿ&;à‘#ÿ%9à‘"ÿàåÿ$(à‘!–!–!r    c                 Û2   ó d| j         j        õ d| j        õdùS )N˙<z	 sockets=˙>)⁄	__class__rß   r∑   ró   s    r   ⁄__repr__zServer.__repr__"  s"   Ä ÿFê4î>‘*–F–F∞T¥\–F–F–F–Fr    c                 Û8   ó | j         ÄJ Ç| xj        dz  c_        d S rp   )r¨   r≠   ró   s    r   ⁄_attachzServer._attach%  s*   Ä ÿå}–(–(–(ÿ–‘òa—–‘––r    c                 Ûî   ó | j         dk    sJ Ç| xj         dz  c_         | j         dk    r| j        Ä| †                    ¶   ´          d S d S d S )Nr   r   )r≠   r¨   ⁄_wakeupró   s    r   ⁄_detachzServer._detach)  s^   Ä ÿ‘!†A“%–%–%–%ÿ–‘òa—–‘ÿ‘†“"–"†t§}–'<ÿèLäLâNåNàNàNàN #–"–'<–'<r    c                 Û~   ó | j         }d | _         |D ]+}|†                    ¶   ´         s|†                    |¶  ´         å,d S rO   )rÆ   ⁄donerö   )rá   ⁄waiters⁄waiters      r   r≈   zServer._wakeup/  sN   Ä ÿî-àÿàåÿ 	* 	*àFÿó;í;ë=î= *ÿ◊!“!†&—)‘)–)¯	* 	*r    c           
      Û‡   ó | j         rd S d| _         | j        D ]U}|†                    | j        ¶  ´         | j        †                    | j        || j        | | j        | j        | j	        ¶  ´         åVd S )NT)
r¥   r¨   ⁄listenr∞   rÑ   ⁄_start_servingrØ   r±   r≤   r≥   )rá   r0   s     r   rÕ   zServer._start_serving6  sÖ   Ä ÿå= 	ÿàFÿàåÿîM 	, 	,àDÿèKäKòú—&‘&–&ÿåJ◊%“%ÿ‘&®®d‘.?ÿêdîm†T‘%@ÿ‘*Ò,Ù , , ,	, 	,r    c                 Û   ó | j         S rO   )rÑ   ró   s    r   ⁄get_loopzServer.get_loopA  s
   Ä ÿåz–r    c                 Û   ó | j         S rO   )r¥   ró   s    r   ⁄
is_servingzServer.is_servingD  s
   Ä ÿå}–r    c                 ÛP   ó | j         ÄdS t          dÑ | j         D ¶   ´         ¶  ´        S )NrP   c              3   Û>   K  ó | ]}t          j        |¶  ´        V ó åd S rO   )r   ⁄TransportSocket)rQ   ⁄ss     r   rS   z!Server.sockets.<locals>.<genexpr>K  s-   Ë Ë Ä –F–F∞1ïV‘+®A—.‘.–F–F–F–F–F–Fr    )r¨   ⁄tupleró   s    r   r∑   zServer.socketsG  s.   Ä ‡å=– ÿê2›–F–F∏º–F—F‘F—F‘F–Fr    c                 Û8  ó | j         }|Äd S d | _         |D ]}| j        †                    |¶  ´         åd| _        | j        Å9| j        †                    ¶   ´         s | j        †                    ¶   ´          d | _        | j        dk    r| †                    ¶   ´          d S d S )NFr   )	r¨   rÑ   ⁄_stop_servingr¥   rµ   r»   r•   r≠   r≈   )rá   r∑   r0   s      r   ⁄closezServer.closeM  s≠   Ä ÿî-àÿà?ÿàFÿàå‡ 	+ 	+àDÿåJ◊$“$†T—*‘*–*–*‡àå‡‘%–1ÿ‘-◊2“2—4‘4 2‡‘%◊,“,—.‘.–.ÿ(,àD‘%‡‘†“"–"ÿèLäLâNåNàNàNàN #–"r    c              É   Ûf   K  ó | †                     ¶   ´          t          j        d¶  ´        É d {V óÜ d S )Nr   )rÕ   r   ⁄sleepró   s    r   ⁄start_servingzServer.start_serving`  s@   Ë Ë Ä ÿ◊“—‘–ı åkò!ânån–––––––––r    c              É   Û¨  K  ó | j         Åt          d| õdù¶  ´        Ç| j        Ät          d| õdù¶  ´        Ç| †                    ¶   ´          | j        †                    ¶   ´         | _         	 | j         É d {V óÜ nH# t          j        $ r6 	 | †                    ¶   ´          | †	                    ¶   ´         É d {V óÜ Ç # Ç xY ww xY w	 d | _         d S # d | _         w xY w)Nzserver z, is already being awaited on serve_forever()z
 is closed)
rµ   rê   r¨   rÕ   rÑ   rÖ   r   ⁄CancelledErrorrŸ   ⁄wait_closedró   s    r   ⁄serve_foreverzServer.serve_foreverf  s(  Ë Ë Ä ÿ‘$–0›ÿNò$–N–N–NÒPÙ P P‡å=– ›–;®–;–;–;—<‘<–<‡◊“—‘–ÿ$(§J◊$<“$<—$>‘$>à‘!		-ÿ‘+–+–+–+–+–+–+–+–+¯›‘( 	 	 	ÿó
í
ëîêÿ◊&“&—(‘(–(–(–(–(–(–(–(‡¯êêêê	¯¯¯ , )-àD‘%–%–%¯®àD‘%–,–,–,–,s6   ¡*A8 ¡7C
 ¡8B=¬.B7¬6B=¬7B9¬9B=¬=C
 √
	Cc              É   Û†   K  ó | j         Å| j        Äd S | j        †                    ¶   ´         }| j        †                    |¶  ´         |É d {V óÜ d S rO   )r¨   rÆ   rÑ   rÖ   rA   )rá   r    s     r   rﬂ   zServer.wait_closed{  sX   Ë Ë Ä ÿå=– †D§M–$9ÿàFÿî◊)“)—+‘+àÿå◊“òV—$‘$–$ÿàààààààààr    rO   )rß   r®   r©   râ   r¡   r√   r∆   r≈   rÕ   rœ   r—   ⁄propertyr∑   rŸ   r‹   r‡   rﬂ   rP   r    r   r   r     sÙ   Ä Ä Ä Ä Ä  >B) ) ) )G G G       * * *	, 	, 	,     G GÒ ÑXG
  &  - - -*    r    r   c                   ÛJ  ó e Zd ZdÑ ZdÑ ZdÑ ZdddúdÑZdÑ ZdÑ Zd\ddd	úd
ÑZ		 d\ddddddddúdÑZ
	 d]dÑZ	 	 d^dÑZ	 	 d^dÑZ	 d\dÑZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ ZdÑ Zd Ñ Zd!Ñ Zej        fd"ÑZ d#Ñ Z!d$Ñ Z"dd%úd&ÑZ#dd%úd'ÑZ$dd%úd(ÑZ%d)Ñ Z&d*Ñ Z'd+Ñ Z(dd%úd,ÑZ)d-Ñ Z*d.Ñ Z+d/Ñ Z,d0d0d0d0d1úd2ÑZ-d_d3ÑZ.d`dd4úd5ÑZ/d6Ñ Z0d7Ñ Z1d8Ñ Z2d\d9ÑZ3	 d^dd0d0d0dddddddd:úd;ÑZ4	 	 	 dad<ÑZ5d`dd4úd=ÑZ6d>Ñ Z7d?Ñ Z8ddddd@údAÑZ9	 d^d0d0d0ddddBúdCÑZ:d0e;j<        d0d0d1údDÑZ=dEÑ Z>	 d^e;j?        e;j@        ddFdddddddGú
dHÑZAddddIúdJÑZBdKÑ ZCdLÑ ZDdMÑ ZEeFjG        eFjG        eFjG        ddd0ddddNú	dOÑZHeFjG        eFjG        eFjG        ddd0ddddNú	dPÑZIdQÑ ZJdRÑ ZKdSÑ ZLdTÑ ZMdUÑ ZNdVÑ ZOdWÑ ZPdXÑ ZQdYÑ ZRdZÑ ZSd[Ñ ZTdS )br   c                 Û¿  ó d| _         d| _        d| _        t          j        ¶   ´         | _        g | _        d | _        d| _        d | _	        t          j        d¶  ´        j        | _        d | _        | †                    t!          j        ¶   ´         ¶  ´         d| _        d | _        d | _        d| _        d | _        t/          j        ¶   ´         | _        d| _        d| _        d S )Nr   F⁄	monotonicgöôôôôôπ?)⁄_timer_cancelled_count⁄_closed⁄	_stoppingrT   ⁄deque⁄_ready⁄
_scheduled⁄_default_executor⁄_internal_fds⁄
_thread_id⁄time⁄get_clock_info⁄
resolution⁄_clock_resolution⁄_exception_handler⁄	set_debugr   ⁄_is_debug_mode⁄slow_callback_duration⁄_current_handle⁄_task_factory⁄"_coroutine_origin_tracking_enabled⁄&_coroutine_origin_tracking_saved_depth⁄weakref⁄WeakSet⁄
_asyncgens⁄_asyncgens_shutdown_called⁄_executor_shutdown_calledró   s    r   râ   zBaseEventLoop.__init__Ö  s“   Ä ÿ&'à‘#ÿàåÿàå›!‘'—)‘)àåÿàåÿ!%à‘ÿà‘ àå›!%‘!4∞[—!A‘!A‘!Là‘ÿ"&à‘ÿèäïz‘0—2‘2—3‘3–3 '*à‘#ÿ#à‘ÿ!à‘ÿ27à‘/ÿ6:à‘3ı "ú/—+‘+àå‡*/à‘'‡).à‘&–&–&r    c           	      Û†   ó d| j         j        õ d| †                    ¶   ´         õ d| †                    ¶   ´         õ d| †                    ¶   ´         õ dù	S )Nræ   z	 running=z closed=z debug=rø   )r¿   rß   ⁄
is_running⁄	is_closed⁄	get_debugró   s    r   r¡   zBaseEventLoop.__repr__£  sp   Ä Cêî‘' C C∞$∑/≤/—2C‘2C C Cÿónín—&‘&C Cÿ/3Ø~™~—/?‘/?C C C	
r    c                 Û,   ó t          j        | ¨¶  ´        S )z,Create a Future object attached to the loop.©r∂   )r   ⁄Futureró   s    r   rÖ   zBaseEventLoop.create_future©  s   Ä Âå~†4–(—(‘(–(r    N)⁄name⁄contextc                Û  ó | †                     ¶   ´          | j        Ä(t          j        || ||¨¶  ´        }|j        r|j        d= nF|Ä| †                    | |¶  ´        }n| †                    | ||¨¶  ´        }t          j        ||¶  ´         |S )zDSchedule a coroutine object.

        Return a task object.
        N)r∂   r  r  Èˇˇˇˇ©r  )⁄_check_closedr¯   r   r   ⁄_source_traceback⁄_set_task_name)rá   ⁄coror  r  ⁄tasks        r   ⁄create_taskzBaseEventLoop.create_task≠  sú   Ä 
 	◊“—‘–ÿ‘–%›î:òd®∞D¿'–J—J‘JàDÿ‘% /ÿ‘*®2–.¯‡à‡◊)“)®$∞—5‘5êê‡◊)“)®$∞∏g–)—F‘FêÂ‘ ††t—,‘,–,‡àr    c                 ÛT   ó |Åt          |¶  ´        st          d¶  ´        Ç|| _        dS )aw  Set a task factory that will be used by loop.create_task().

        If factory is None the default task factory will be set.

        If factory is a callable, it should have a signature matching
        '(loop, coro)', where 'loop' will be a reference to the active
        event loop, 'coro' will be a coroutine object.  The callable
        must return a Future.
        Nz'task factory must be a callable or None)⁄callabler=   r¯   )rá   ⁄factorys     r   ⁄set_task_factoryzBaseEventLoop.set_task_factory¬  s4   Ä  –•x∞—'8‘'8–›–E—F‘F–Fÿ$à‘––r    c                 Û   ó | j         S )z<Return a task factory, or None if the default one is in use.)r¯   ró   s    r   ⁄get_task_factoryzBaseEventLoop.get_task_factory–  s   Ä ‡‘!–!r    )⁄extra⁄serverc                Û   ó t           Ç)zCreate socket transport.©⁄NotImplementedError)rá   r0   ⁄protocolr    r  r  s         r   ⁄_make_socket_transportz$BaseEventLoop._make_socket_transport‘  Û
   Ä ı "–!r    FT)⁄server_side⁄server_hostnamer  r  rª   rº   ⁄call_connection_madec                Û   ó t           Ç)zCreate SSL transport.r  )rá   ⁄rawsockr  ⁄
sslcontextr    r   r!  r  r  rª   rº   r"  s               r   ⁄_make_ssl_transportz!BaseEventLoop._make_ssl_transportŸ  s
   Ä ı "–!r    c                 Û   ó t           Ç)zCreate datagram transport.r  )rá   r0   r  ⁄addressr    r  s         r   ⁄_make_datagram_transportz&BaseEventLoop._make_datagram_transport„  r  r    c                 Û   ó t           Ç)zCreate read pipe transport.r  ©rá   ⁄piper  r    r  s        r   ⁄_make_read_pipe_transportz'BaseEventLoop._make_read_pipe_transportË  r  r    c                 Û   ó t           Ç)zCreate write pipe transport.r  r+  s        r   ⁄_make_write_pipe_transportz(BaseEventLoop._make_write_pipe_transportÌ  r  r    c	              ã   Û   K  ó t           Ç)zCreate subprocess transport.r  )
rá   r  ⁄args⁄shell⁄stdin⁄stdout⁄stderr⁄bufsizer  ⁄kwargss
             r   ⁄_make_subprocess_transportz(BaseEventLoop._make_subprocess_transportÚ  s   Ë Ë Ä ı "–!r    c                 Û   ó t           Ç)z∏Write a byte to self-pipe, to wake up the event loop.

        This may be called from a different thread.

        The subclass is responsible for implementing the self-pipe.
        r  ró   s    r   ⁄_write_to_selfzBaseEventLoop._write_to_self¯  s
   Ä ı "–!r    c                 Û   ó t           Ç)zProcess selector events.r  )rá   ⁄
event_lists     r   ⁄_process_eventszBaseEventLoop._process_events  s   Ä Â!–!r    c                 Û2   ó | j         rt          d¶  ´        Çd S )NzEvent loop is closed)rÁ   rê   ró   s    r   r  zBaseEventLoop._check_closed  s%   Ä ÿå< 	7›–5—6‘6–6	7 	7r    c                 Û2   ó | j         rt          d¶  ´        Çd S )Nz!Executor shutdown has been called)rˇ   rê   ró   s    r   ⁄_check_default_executorz%BaseEventLoop._check_default_executor	  s)   Ä ÿ‘) 	D›–B—C‘C–C	D 	Dr    c                 Û¿   ó | j         †                    |¶  ´         | †                    ¶   ´         s/| †                    | j        |†                    ¶   ´         ¶  ´         d S d S rO   )r˝   ⁄discardr  ⁄call_soon_threadsafer  ⁄aclose©rá   ⁄agens     r   ⁄_asyncgen_finalizer_hookz&BaseEventLoop._asyncgen_finalizer_hook  s^   Ä ÿå◊“†—%‘%–%ÿè~ä~—‘ 	Gÿ◊%“%†d‘&6∏ø∫πº—F‘F–F–F–F	G 	Gr    c                 Ûà   ó | j         r t          j        d|õdùt          | ¨¶  ´         | j        †                    |¶  ´         d S )Nzasynchronous generator z3 was scheduled after loop.shutdown_asyncgens() call©⁄source)r˛   ⁄warnings⁄warn⁄ResourceWarningr˝   ⁄addrE  s     r   ⁄_asyncgen_firstiter_hookz&BaseEventLoop._asyncgen_firstiter_hook  s_   Ä ÿ‘* 	.›åM2®$ 2 2 2Â®.Ò .Ù . .
 	å◊“òD—!‘!–!–!–!r    c              É   Ûn  K  ó d| _         t          | j        ¶  ´        sdS t          | j        ¶  ´        }| j        †                    ¶   ´          t          j        dÑ |D ¶   ´         ddiéÉ d{V óÜ}t          ||¶  ´        D ]6\  }}t          |t          ¶  ´        r| †
                    d|õù||dú¶  ´         å7dS )z,Shutdown all active asynchronous generators.TNc                 Û6   ó g | ]}|†                     ¶   ´         ëåS rP   )rD  )rQ   ⁄ags     r   ˙
<listcomp>z4BaseEventLoop.shutdown_asyncgens.<locals>.<listcomp>(  s    Ä –2–2–2òbàbèiäiâkåk–2–2–2r    ⁄return_exceptionsz;an error occurred during closing of asynchronous generator )⁄messagerf   ⁄asyncgen)r˛   ⁄lenr˝   rV   ⁄clearr   ⁄gather⁄zipr   ⁄	Exception⁄call_exception_handler)rá   ⁄closing_agens⁄results⁄resultrF  s        r   ⁄shutdown_asyncgensz BaseEventLoop.shutdown_asyncgens  s  Ë Ë Ä ‡*.à‘'Âê4î?—#‘# 	 àFÂòTú_—-‘-àÿå◊“—‘–Âúÿ2–2†M–2—2‘2$‡"$ $ $ $ $ $ $ $àı  †®—7‘7 	 	âLàFêD›ò&•)—,‘, ÿ◊+“+ Bÿ9= B  B‡!'ÿ $	- -Ò Ù  ¯	 	r    c              É   Û  K  ó d| _         | j        ÄdS | †                    ¶   ´         }t          j        | j        |f¨¶  ´        }|†                    ¶   ´          	 |É d{V óÜ |†                    ¶   ´          dS # |†                    ¶   ´          w xY w)z.Schedule the shutdown of the default executor.TN)⁄targetr1  )rˇ   rÏ   rÖ   ⁄	threading⁄Thread⁄_do_shutdown⁄start⁄join)rá   ⁄future⁄threads      r   ⁄shutdown_default_executorz'BaseEventLoop.shutdown_default_executor4  sç   Ë Ë Ä ‡)-à‘&ÿ‘!–)ÿàFÿ◊#“#—%‘%à›‘!®‘):¿&¿–K—K‘Kàÿèäâåà	ÿàLàLàLàLàLàLàL‡èKäKâMåMàMàMàM¯àFèKäKâMåMàMàM¯¯¯s   ¡A6 ¡6Bc                 Û:  ó 	 | j         †                    d¨¶  ´         | †                    ¶   ´         s| †                    |j        d ¶  ´         d S d S # t
          $ r@}| †                    ¶   ´         s!| †                    |j        |¶  ´         Y d }~d S Y d }~d S d }~ww xY w)NT©⁄wait)rÏ   ⁄shutdownr  rC  rö   r[  rî   )rá   rh  ⁄exs      r   re  zBaseEventLoop._do_shutdownA  sÂ   Ä 	Dÿ‘"◊+“+∞–+—6‘6–6ÿó>í>—#‘# Cÿ◊)“)®&‘*;∏T—B‘B–B–B–BC C¯Â 	D 	D 	Dÿó>í>—#‘# Dÿ◊)“)®&‘*>¿—C‘C–C–C–C–C–C–C–CD D D D D D¯¯¯¯	D¯¯¯s   ÇA
A ¡
B¡/B¬Bc                 Ûê   ó | †                     ¶   ´         rt          d¶  ´        Çt          j        ¶   ´         Åt          d¶  ´        Çd S )Nz"This event loop is already runningz7Cannot run the event loop while another loop is running)r  rê   r   ⁄_get_running_loopró   s    r   ⁄_check_runningzBaseEventLoop._check_runningJ  sS   Ä ÿè?ä?—‘ 	E›–C—D‘D–D›‘#—%‘%–1›ÿIÒKÙ K K 2–1r    c                 Û¶  ó | †                     ¶   ´          | †                    ¶   ´          | †                    | j        ¶  ´         t	          j        ¶   ´         }	 t          j        ¶   ´         | _        t	          j	        | j
        | j        ¨¶  ´         t          j        | ¶  ´         	 | †                    ¶   ´          | j        rnå	 d| _        d| _        t          j        d¶  ´         | †                    d¶  ´         t	          j	        |é  dS # d| _        d| _        t          j        d¶  ´         | †                    d¶  ´         t	          j	        |é  w xY w)zRun until stop() is called.)⁄	firstiter⁄	finalizerTFN)r  rr  ⁄_set_coroutine_origin_tracking⁄_debug⁄sys⁄get_asyncgen_hooksrc  ⁄	get_identrÓ   ⁄set_asyncgen_hooksrO  rG  r   ⁄_set_running_loop⁄	_run_oncerË   )rá   ⁄old_agen_hookss     r   ⁄run_foreverzBaseEventLoop.run_foreverQ  sX  Ä ‡◊“—‘–ÿ◊“—‘–ÿ◊+“+®D¨K—8‘8–8Â‘/—1‘1à	4›'‘1—3‘3àDåO›‘"®T‘-Jÿ-1‘-JLÒ LÙ L Lı ‘$†T—*‘*–*ÿóí— ‘ – ÿî> ÿ ‡"àDåNÿ"àDåO›‘$†T—*‘*–*ÿ◊/“/∞—6‘6–6›‘"†N–3–3–3–3¯	 #àDåNÿ"àDåO›‘$†T—*‘*–*ÿ◊/“/∞—6‘6–6›‘"†N–3–3–3¯¯¯s   ¡A*D	 ƒ	AEc                 ÛÜ  ó | †                     ¶   ´          | †                    ¶   ´          t          j        |¶  ´         }t	          j        || ¨¶  ´        }|rd|_        |†                    t          ¶  ´         	 | †	                    ¶   ´          nD#  |r<|†
                    ¶   ´         r(|†                    ¶   ´         s|†                    ¶   ´          Ç xY w	 |†                    t          ¶  ´         n# |†                    t          ¶  ´         w xY w|†
                    ¶   ´         st          d¶  ´        Ç|†                    ¶   ´         S )a\  Run until the Future is done.

        If the argument is a coroutine, it is wrapped in a Task.

        WARNING: It would be disastrous to call run_until_complete()
        with the same coroutine twice -- it would wrap it in two
        different Tasks and that can't be good.

        Return the Future's result, or raise its exception.
        r  Fz+Event loop stopped before Future completed.)r  rr  r   ⁄isfuturer   ⁄ensure_future⁄_log_destroy_pending⁄add_done_callbackrm   r  r»   re   rf   ⁄remove_done_callbackrê   r_  )rá   rh  ⁄new_tasks      r   ⁄run_until_completez BaseEventLoop.run_until_completei  sD  Ä  	◊“—‘–ÿ◊“—‘–Â‘'®—/‘/–/à›‘$†V∞$–7—7‘7àÿ 	0 +0àF‘'‡◊ “ ’!7—8‘8–8
	@ÿ◊“—‘––¯	ÿ #òFüKöKôMúM #∞&◊2B“2B—2D‘2D # ◊ “ —"‘"–"ÿ¯¯¯  ◊'“'’(>—?‘?–?–?¯àF◊'“'’(>—?‘?–?–?¯¯¯ÿè{ä{â}å} 	N›–L—M‘M–M‡è}ä}âå–s   ¡8B ¬C- ¬AC√C- √-D	c                 Û   ó d| _         dS )z¥Stop running the event loop.

        Every callback already scheduled will still run.  This simply informs
        run_forever to stop looping after a complete iteration.
        TN)rË   ró   s    r   rj   zBaseEventLoop.stopè  s   Ä  àåààr    c                 Ûf  ó | †                     ¶   ´         rt          d¶  ´        Ç| j        rdS | j        rt	          j        d| ¶  ´         d| _        | j        †                    ¶   ´          | j        †                    ¶   ´          d| _	        | j
        }|Åd| _
        |†                    d¨¶  ´         dS dS )zæClose the event loop.

        This clears the queues and shuts down the executor,
        but does not wait for the executor to finish.

        The event loop must not be running.
        z!Cannot close a running event loopNzClose %rTFrl  )r  rê   rÁ   rw  r   ⁄debugrÍ   rX  rÎ   rˇ   rÏ   rn  ©rá   ⁄executors     r   rŸ   zBaseEventLoop.closeó  s√   Ä  è?ä?—‘ 	D›–B—C‘C–Cÿå< 	ÿàFÿå; 	+›åLò†T—*‘*–*ÿàåÿå◊“—‘–ÿå◊“—‘–ÿ)-à‘&ÿ‘)àÿ–ÿ%)àD‘"ÿ◊“†5–—)‘)–)–)–)  –r    c                 Û   ó | j         S )z*Returns True if the event loop was closed.)rÁ   ró   s    r   r  zBaseEventLoop.is_closedÆ  s
   Ä ‡å|–r    c                 Û≤   ó | †                     ¶   ´         s@ |d| õùt          | ¨¶  ´         | †                    ¶   ´         s| †                    ¶   ´          d S d S d S )Nzunclosed event loop rI  )r  rM  r  rŸ   )rá   ⁄_warns     r   ⁄__del__zBaseEventLoop.__del__≤  sk   Ä ÿè~ä~—‘ 	ÿàE–1®–1–1µ?»4–P—P‘P–Pÿó?í?—$‘$ ÿó
í
ëîêêê	 	 r    c                 Û   ó | j         duS )z*Returns True if the event loop is running.N)rÓ   ró   s    r   r  zBaseEventLoop.is_running∏  s   Ä ‡î†t–+–,r    c                 Û(   ó t          j        ¶   ´         S )zÁReturn the time according to the event loop's clock.

        This is a float expressed in seconds since an epoch, but the
        epoch, precision, accuracy and drift are unspecified and may
        differ per event loop.
        )rÔ   rÂ   ró   s    r   rÔ   zBaseEventLoop.timeº  s   Ä ı å~—‘–r    r  c                Ûî   ó |Ät          d¶  ´        Ç | j        | †                    ¶   ´         |z   |g|¢R d|ié}|j        r|j        d= |S )a8  Arrange for a callback to be called at a given time.

        Return a Handle: an opaque object with a cancel() method that
        can be used to cancel the call.

        The delay can be an int or float, expressed in seconds.  It is
        always relative to the current time.

        Each callback will be called exactly once.  If two callbacks
        are scheduled for exactly the same time, it undefined which
        will be called first.

        Any positional arguments after the callback will be passed to
        the callback when it is called.
        Nzdelay must not be Noner  r
  )r=   ⁄call_atrÔ   r  )rá   ⁄delay⁄callbackr  r1  ⁄timers         r   ⁄
call_laterzBaseEventLoop.call_later≈  sp   Ä   à=›–4—5‘5–5ÿêîòTüYöYô[ú[®5—0∞( .∏T . . .ÿ%,. .à‡‘" 	,ÿ‘'®–+ÿàr    c                ÛB  ó |Ät          d¶  ´        Ç| †                    ¶   ´          | j        r*| †                    ¶   ´          | †                    |d¶  ´         t          j        |||| |¶  ´        }|j        r|j        d= t          j	        | j
        |¶  ´         d|_
        |S )z|Like call_later(), but uses an absolute time.

        Absolute time corresponds to the event loop's time() method.
        Nzwhen cannot be Nonerî  r
  T)r=   r  rw  ⁄_check_thread⁄_check_callbackr   ⁄TimerHandler  ⁄heapq⁄heappushrÎ   )rá   ⁄whenrñ  r  r1  ró  s         r   rî  zBaseEventLoop.call_at›  s´   Ä 
 à<›–1—2‘2–2ÿ◊“—‘–ÿå; 	6ÿ◊“— ‘ – ÿ◊ “ †®9—5‘5–5›‘"†4®∞4∏∏w—G‘Gàÿ‘" 	,ÿ‘'®–+›åêtî®—.‘.–.ÿà‘ÿàr    c                Û‹   ó | †                     ¶   ´          | j        r*| †                    ¶   ´          | †                    |d¶  ´         | †                    |||¶  ´        }|j        r|j        d= |S )aT  Arrange for a callback to be called as soon as possible.

        This operates as a FIFO queue: callbacks are called in the
        order in which they are registered.  Each callback will be
        called exactly once.

        Any positional arguments after the callback will be passed to
        the callback when it is called.
        ⁄	call_soonr
  )r  rw  rö  rõ  ⁄
_call_soonr  ©rá   rñ  r  r1  r   s        r   r°  zBaseEventLoop.call_soonÔ  sx   Ä  	◊“—‘–ÿå; 	8ÿ◊“— ‘ – ÿ◊ “ †®;—7‘7–7ÿóí†®4∞—9‘9àÿ‘# 	-ÿ‘(®–,ÿàr    c                 Ûƒ   ó t          j        |¶  ´        st          j        |¶  ´        rt          d|õ dù¶  ´        Çt	          |¶  ´        st          d|õ d|õù¶  ´        Çd S )Nzcoroutines cannot be used with z()z"a callable object was expected by z(), got )r   ⁄iscoroutine⁄iscoroutinefunctionr=   r  )rá   rñ  ⁄methods      r   rõ  zBaseEventLoop._check_callback  sí   Ä ›‘"†8—,‘, 	>›‘.®x—8‘8	>Âÿ<∞&–<–<–<Ò>Ù > >Âò—!‘! 	%›$∞V $ $ÿ$ $Ò%Ù % %	% 	%r    c                 ÛÜ   ó t          j        ||| |¶  ´        }|j        r|j        d= | j        †                    |¶  ´         |S )Nr
  )r   ⁄Handler  rÍ   rA   )rá   rñ  r1  r  r   s        r   r¢  zBaseEventLoop._call_soon  sH   Ä ›îòx®®t∞W—=‘=àÿ‘# 	-ÿ‘(®–,ÿå◊“ò6—"‘"–"ÿàr    c                 Ûr   ó | j         ÄdS t          j        ¶   ´         }|| j         k    rt          d¶  ´        ÇdS )ao  Check that the current thread is the thread running the event loop.

        Non-thread-safe methods of this class make this assumption and will
        likely behave incorrectly when the assumption is violated.

        Should only be called when (self._debug == True).  The caller is
        responsible for checking this condition for performance reasons.
        NzMNon-thread-safe operation invoked on an event loop other than the current one)rÓ   rc  rz  rê   )rá   ⁄	thread_ids     r   rö  zBaseEventLoop._check_thread  sK   Ä  å?–"ÿàF›‘'—)‘)à	ÿòú“'–'›'Ò(Ù ( ( (–'r    c                Û‹   ó | †                     ¶   ´          | j        r| †                    |d¶  ´         | †                    |||¶  ´        }|j        r|j        d= | †                    ¶   ´          |S )z"Like call_soon(), but thread-safe.rC  r
  )r  rw  rõ  r¢  r  r:  r£  s        r   rC  z"BaseEventLoop.call_soon_threadsafe$  sx   Ä ‡◊“—‘–ÿå; 	Cÿ◊ “ †–+A—B‘B–Bÿóí†®4∞—9‘9àÿ‘# 	-ÿ‘(®–,ÿ◊“—‘–ÿàr    c                 Û4  ó | †                     ¶   ´          | j        r| †                    |d¶  ´         |ÄD| j        }| †                    ¶   ´          |Ä't
          j        †                    d¨¶  ´        }|| _        t          j         |j	        |g|¢R é | ¨¶  ´        S )N⁄run_in_executor⁄asyncio)⁄thread_name_prefixr  )
r  rw  rõ  rÏ   r@  ⁄
concurrentr   ⁄ThreadPoolExecutor⁄wrap_future⁄submit)rá   rå  ⁄funcr1  s       r   rÆ  zBaseEventLoop.run_in_executor/  sπ   Ä ÿ◊“—‘–ÿå; 	:ÿ◊ “ †–'8—9‘9–9ÿ–ÿ‘-àH‡◊(“(—*‘*–*ÿ–›%‘-◊@“@ÿ'0 AÒ Ù ê *2ê‘&›‘"ÿàHåOòD–(†4–(–(–(®t5Ò 5Ù 5 	5r    c                 Ûp   ó t          |t          j        j        ¶  ´        st	          d¶  ´        Ç|| _        d S )Nz,executor must be ThreadPoolExecutor instance)r   r±  r   r≤  r=   rÏ   rã  s     r   ⁄set_default_executorz"BaseEventLoop.set_default_executor?  s8   Ä ›ò(•J‘$6‘$I—J‘J 	L›–J—K‘K–Kÿ!)à‘––r    c                 ÛH  ó |õ d|õùg}|r|†                     d|õù¶  ´         |r|†                     d|õù¶  ´         |r|†                     d|õù¶  ´         |r|†                     d|õù¶  ´         d†                    |¶  ´        }t          j        d|¶  ´         | †                    ¶   ´         }t          j        ||||||¶  ´        }	| †                    ¶   ´         |z
  }
d|õ d	|
d
z  dõd|	õù}|
| j        k    rt          j        |¶  ´         nt          j        |¶  ´         |	S )N˙:zfamily=ztype=zproto=zflags=˙, zGet address info %szGetting address info z took g     @è@z.3fzms: )	rA   rg  r   rä  rÔ   r*   ⁄getaddrinforˆ   ⁄info)rá   rC   rD   rE   rF   rG   ⁄flags⁄msg⁄t0⁄addrinfo⁄dts              r   ⁄_getaddrinfo_debugz BaseEventLoop._getaddrinfo_debugD  sY  Ä ÿ–!–!ò–!–!–"àÿ 	-ÿèJäJ–+†–+–+—,‘,–,ÿ 	)ÿèJäJ–'òt–'–'—(‘(–(ÿ 	+ÿèJäJ–)†–)–)—*‘*–*ÿ 	+ÿèJäJ–)†–)–)—*‘*–*ÿèiäiòânånà›å–*®C—0‘0–0‡èYäYâ[å[à›‘%†d®D∞&∏$¿¿u—M‘MàÿèYäYâ[å[ò2—à‡O†c–O–O∞∞c±–O–O–O¿8–O–Oàÿê‘,“,–,›åKò—‘––ÂåLò—‘–ÿàr    r   ©rE   rF   rG   rΩ  c          
   É   ÛÄ   K  ó | j         r| j        }nt          j        }| †                    d |||||||¶  ´        É d {V óÜS rO   )rw  r¬  r*   rª  rÆ  )rá   rC   rD   rE   rF   rG   rΩ  ⁄getaddr_funcs           r   rª  zBaseEventLoop.getaddrinfo\  sr   Ë Ë Ä ‡å; 	.ÿ‘2àLàLÂ!‘-àL‡◊)“)ÿê,††d®F∞D∏%¿ÒHÙ H H H H H H H 	Hr    c              É   ÛV   K  ó | †                     d t          j        ||¶  ´        É d {V óÜS rO   )rÆ  r*   ⁄getnameinfo)rá   ⁄sockaddrrΩ  s      r   r«  zBaseEventLoop.getnameinfof  sH   Ë Ë Ä ÿ◊)“)ÿï&‘$†h∞Ò7Ù 7 7 7 7 7 7 7 	7r    )⁄fallbackc             É   Ûh  K  ó | j         r'|†                    ¶   ´         dk    rt          d¶  ´        Çt          |¶  ´         | †                    ||||¶  ´         	 | †                    ||||¶  ´        É d {V óÜS # t          j        $ r}|sÇ Y d }~nd }~ww xY w| †                    ||||¶  ´        É d {V óÜS )Nr   zthe socket must be non-blocking)	rw  ⁄
gettimeoutr+   rv   ⁄_check_sendfile_params⁄_sock_sendfile_nativer   ⁄SendfileNotAvailableError⁄_sock_sendfile_fallback)rá   r0   ⁄file⁄offset⁄countr…  rl   s          r   ⁄sock_sendfilezBaseEventLoop.sock_sendfilej  s9  Ë Ë Ä ‡å; 	@ò4ü?ö?—,‘,∞“1–1›–>—?‘?–?›ò$—‘–ÿ◊#“#†D®$∞∏—>‘>–>	ÿ◊3“3∞D∏$ÿ4:∏EÒCÙ C C C C C C C C¯Â‘3 	 	 	ÿ ÿ    ¯¯¯¯	¯¯¯ ◊1“1∞$∏ÿ28∏%ÒAÙ A A A A A A A 	As   ¡A7 ¡7B¬B¬Bc              É   Û<   K  ó t          j        d|õd|õdù¶  ´        Ç)Nz-syscall sendfile is not available for socket z
 and file z combination©r   rŒ  ©rá   r0   r–  r—  r“  s        r   rÕ  z#BaseEventLoop._sock_sendfile_nativey  s@   Ë Ë Ä ı ‘2-∏D - -ÿ- - -Ò.Ù . 	.r    c              É   Û|  K  ó |r|†                     |¶  ´         |rt          |t          j        ¶  ´        nt          j        }t	          |¶  ´        }d}	 	 |rt          ||z
  |¶  ´        }|dk    rnft          |¶  ´        d |Ö         }| †                    d |j        |¶  ´        É d {V óÜ}	|	sn*| †                    ||d |	Ö         ¶  ´        É d {V óÜ ||	z  }åÇ||dk    r)t          |d¶  ´        r|†                     ||z   ¶  ´         S S S # |dk    r)t          |d¶  ´        r|†                     ||z   ¶  ´         w w w xY w)Nr   T⁄seek)
rÿ  ⁄minr   ⁄!SENDFILE_FALLBACK_READBUFFER_SIZE⁄	bytearray⁄
memoryviewrÆ  ⁄readinto⁄sock_sendallr)   )
rá   r0   r–  r—  r“  ⁄	blocksize⁄buf⁄
total_sent⁄view⁄reads
             r   rœ  z%BaseEventLoop._sock_sendfile_fallbackÄ  sè  Ë Ë Ä ÿ 	ÿèIäIêf—‘– FçCêïy‘B—C‘C–C›#‘E 	ı ò	—"‘"àÿà
	/
#ÿ › #†E®J—$6∏	— B‘ BêIÿ †Aí~ê~ÿ›!†#ëî†z®	†z‘2êÿ!◊1“1∞$∏º¿t—L‘L–L–L–L–L–L–Lêÿ ÿÿ◊'“'®®d∞5∞D∞5¨k—:‘:–:–:–:–:–:–:–:ÿòd—"ê

# ‡òAä~à~•'®$∞—"7‘"7à~ÿó	í	ò&†:—-—.‘.–.–. à~¯àzòAä~à~•'®$∞—"7‘"7à~ÿó	í	ò&†:—-—.‘.–.–. à~¯¯¯s   ¡BD	 ƒ	2D;c                 Û  ó dt          |dd¶  ´        vrt          d¶  ´        Ç|j        t          j        k    st          d¶  ´        Ç|Å_t          |t          ¶  ´        s"t          d†                    |¶  ´        ¶  ´        Ç|dk    r"t          d†                    |¶  ´        ¶  ´        Çt          |t          ¶  ´        s"t          d†                    |¶  ´        ¶  ´        Ç|dk     r"t          d†                    |¶  ´        ¶  ´        Çd S )N⁄b⁄modez$file should be opened in binary modez+only SOCK_STREAM type sockets are supportedz+count must be a positive integer (got {!r})r   z0offset must be a non-negative integer (got {!r}))	r   r+   rF   r*   r9   r   r<   r=   ⁄formatr÷  s        r   rÃ  z$BaseEventLoop._check_sendfile_paramsö  s)  Ä ÿïgòd†F®C—0‘0–0–0›–C—D‘D–DÿåyùF‘.“.–.›–J—K‘K–Kÿ–›òe•S—)‘) Q›ÿA◊H“H»—O‘OÒQÙ Q Q‡òäzàz› ÿA◊H“H»—O‘OÒQÙ Q QÂò&•#—&‘& 	›ÿB◊I“IÿÒÙ ÒÙ   êAä:à:›ÿB◊I“IÿÒÙ ÒÙ   à:r    c              É   Û   K  ó g } |j         |¶  ´         |\  }}}}}	d}
	 t          j        |||¨¶  ´        }
|
†                    d¶  ´         |Å≤|D ]Ü\  }}}}}||k    rå	 |
†                    |¶  ´          nâ# t          $ rS}d|õd|j        †                    ¶   ´         õ ù}t	          |j        |¶  ´        }|†                     |¶  ´         Y d}~åd}~ww xY w|r|†                    ¶   ´         Çt	          d|õdù¶  ´        Ç| †	                    |
|	¶  ´        É d{V óÜ |
dx}}S # t          $ r1}|†                     |¶  ´         |
Å|
†
                    ¶   ´          Ç d}~w |
Å|
†
                    ¶   ´          Ç xY w# dx}}w xY w)z$Create, bind and connect one socket.N©rE   rF   rG   F˙*error while attempting to bind on address ˙: z&no matching local address with family=z found)rA   r*   ⁄setblocking⁄bindr.   ⁄strerror⁄lower⁄errno⁄pop⁄sock_connectrŸ   )rá   r   ⁄	addr_info⁄local_addr_infos⁄my_exceptionsrE   ⁄type_rG   ⁄_r(  r0   ⁄lfamily⁄laddrrl   ræ  s                  r   ⁄_connect_sockzBaseEventLoop._connect_sockØ  s  Ë Ë Ä ‡àÿà
‘ò-—(‘(–(ÿ+4—(àêêuòa†ÿà$	.›î=®∞U¿%–H—H‘HàDÿ◊“òU—#‘#–#ÿ–+ÿ/? Y Y—+êGòQ††1†e‡†&“(–(ÿ 
2ÿü	ö	†%—(‘(–(ÿò¯›" 2 2 26ÿ',6 6‡"ú|◊1“1—3‘36 6 ı
 &†c§i∞—5‘5òÿ%◊,“,®S—1‘1–1–1–1–1–1–1¯¯¯¯2¯¯¯ % Yÿ+◊/“/—1‘1–1Â%–&W»–&W–&W–&W—X‘X–Xÿ◊#“#†D®'—2‘2–2–2–2–2–2–2–2ÿ *.–-àJòò¯ı  	 	 	ÿ◊ “ †—%‘%–%ÿ–ÿó
í
ëîêÿ¯¯¯¯	ÿ–ÿó
í
ëîêÿ¯¯¯¯‡)-–-àJò–-–-–-–-sO   †?D" ¡ A7¡5D" ¡7
C¬A	C√
D" √C√A	D" ƒ"
E4ƒ,,E≈E4≈4E7 ≈7E=)rt   rE   rG   rΩ  r0   ⁄
local_addrr!  rª   rº   ⁄happy_eyeballs_delay⁄
interleavec             É   Ûv  á áááK  ó |
Å|st          d¶  ´        Ç|
Ä|r|st          d¶  ´        Ç|}
|Å|st          d¶  ´        Ç|Å|st          d¶  ´        Ç|Åt          |¶  ´         |Å|Äd}|Ä|êÅ≥|Åt          d¶  ´        Çâ †                    ||f|t          j        ||â ¨¶  ´        É d{V óÜ}|st          d	¶  ´        Ç|	Å=â †                    |	|t          j        ||â ¨¶  ´        É d{V óÜäâst          d	¶  ´        Çndä|rt          ||¶  ´        }g ä|Ä5|D ]1}	 â †                    â|â¶  ´        É d{V óÜ} n# t
          $ r Y å.w xY wn/t          j	        ààà fd
Ñ|D ¶   ´         |â ¨¶  ´        É d{V óÜ\  }}}|Ä¶dÑ âD ¶   ´         ä	 t          â¶  ´        dk    râd         Çt          âd         ¶  ´        ät          àfdÑâD ¶   ´         ¶  ´        râd         Çt          d†                    d†                    dÑ âD ¶   ´         ¶  ´        ¶  ´        ¶  ´        Ç# däw xY wn8|Ät          d¶  ´        Ç|j        t          j        k    rt          d|õù¶  ´        Çâ †                    ||||
||¨¶  ´        É d{V óÜ\  }}â j        r.|†                    d¶  ´        }t'          j        d|||||¶  ´         ||fS )aˆ  Connect to a TCP server.

        Create a streaming transport connection to a given internet host and
        port: socket family AF_INET or socket.AF_INET6|  |   |  !|  "|  #|  $|  %|  &|  '|  (|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       depending on host (or
        family if specified), socket type SOCK_STREAM. protocol_factory must be
        a callable returning a protocol instance.

        This method is a coroutine which will try to establish the connection
        in the background.  When successful, the coroutine returns a
        (transport, protocol) pair.
        Nz+server_hostname is only meaningful with sslz:You must set server_hostname when using ssl without a host˙1ssl_handshake_timeout is only meaningful with ssl˙0ssl_shutdown_timeout is only meaningful with sslr   ˙8host/port and sock can not be specified at the same time©rE   rF   rG   rΩ  r∂   ˙!getaddrinfo() returned empty listc              3   ÛP   ïK  ó | ] }t          j        âj        â|â¶  ´        V ó å!d S rO   )⁄	functools⁄partialr˙  )rQ   r¿  r   ⁄laddr_infosrá   s     ÄÄÄr   rS   z2BaseEventLoop.create_connection.<locals>.<genexpr>4  sR   ¯Ë Ë Ä  , ,‡!ı ‘&†t‘'9ÿ'1∞8∏[ÒJÙ J , , , , , ,r    r  c                 Û   ó g | ]	}|D ]}|ëåå
S rP   rP   )rQ   ⁄subrl   s      r   rS  z3BaseEventLoop.create_connection.<locals>.<listcomp>:  s%   Ä –G–G–G†c¿3–G–G∏Còc–G–G–G–Gr    r   c              3   Û>   ïK  ó | ]}t          |¶  ´        âk    V ó åd S rO   ©r   )rQ   rl   ⁄models     Är   rS   z2BaseEventLoop.create_connection.<locals>.<genexpr>A  s.   ¯Ë Ë Ä –G–G∞Sùs†3ôxúx®5“0–G–G–G–G–G–Gr    zMultiple exceptions: {}r∫  c              3   Û4   K  ó | ]}t          |¶  ´        V ó åd S rO   r  )rQ   rl   s     r   rS   z2BaseEventLoop.create_connection.<locals>.<genexpr>F  s(   Ë Ë Ä –%E–%E∞3•c®#°h§h–%E–%E–%E–%E–%E–%Er    z5host and port was not specified and no sock specified˙"A Stream Socket was expected, got )rª   rº   r*   z%r connected to %s:%r: (%r, %r))r+   rv   ⁄_ensure_resolvedr*   r9   r.   rc   r˙  r   ⁄staggered_racerW  r   ⁄allrÁ  rg  rF   ⁄_create_connection_transportrw  ⁄get_extra_infor   rä  )rá   r∏   rC   rD   rt   rE   rG   rΩ  r0   r˚  r!  rª   rº   r¸  r˝  ⁄infosr¿  r˜  rë   r  r   r  r  s   `                   @@@r   ⁄create_connectionzBaseEventLoop.create_connection€  s∏  ¯¯¯¯Ë Ë Ä & –&®s–&›–J—K‘K–K‡–"†s–"  B›  "AÒ BÙ B B‡"àO‡ –,∞S–,›ÿCÒEÙ E E  –+∞C–+›ÿBÒDÙ D D –›òd—#‘#–#‡–+∞
–0B‡àJ‡–òt—/ÿ–› ÿNÒPÙ P P ◊/“/ÿêtê†V›‘'®u∏E» 0Ò NÙ N N N N N N NàE  C›–A—B‘B–B‡–%ÿ$(◊$9“$9ÿ†v›‘+∞5ÿ†d %:Ò %,Ù %, , , , , , ,ê # G›!–"E—F‘F–FG #ê‡ A›-®e∞Z—@‘@ê‡àJÿ#–+‡ % ! !êH!ÿ%)◊%7“%7ÿ&®∞+Ò&?Ù &?  ?  ?  ?  ?  ?  ?ò‡ò¯›" ! ! !ÿ ò!¯¯¯¯ı $-‘#;, , , , , ,‡%*,Ò ,Ù , )®t	$5Ò $5Ù $5 5 5 5 5 5 5ë
êêaò à|ÿG–G®Z–G—G‘Gê
&›ò:ëî®!“+–+ÿ(®úm–+ı !$†J®q§M— 2‘ 2ò›–G–G–G–G∏J–G—G‘G—G‘G 0ÿ",®Q§-–/ı &–&?◊&F“&Fÿ üIöI–%E–%E∏*–%E—%E‘%E—E‘EÒ'GÙ 'GÒ HÙ H H¯ "&êJ–%–%–%–% $ à|› ÿKÒMÙ M M‡åyùF‘.“.–.ı !ÿA∏–A–AÒCÙ C C %)◊$E“$Eÿ–"†C®ÿ"7ÿ!5 %FÒ %7Ù %7 7 7 7 7 7 7—à	ê8 å; 	@ ◊+“+®H—5‘5àD›åL–:ÿòt†T®9∞hÒ@Ù @ @‡ò(–"–"s   ƒD=ƒ=
E
≈	E
∆BH »H"c           
   É   Û\  K  ó |†                     d¶  ´          |¶   ´         }| †                    ¶   ´         }	|r7t          |t          ¶  ´        rd n|}
| †                    |||
|	||||¨¶  ´        }n| †                    |||	¶  ´        }	 |	É d {V óÜ n#  |†                    ¶   ´          Ç xY w||fS )NF©r   r!  rª   rº   )rÏ  rÖ   r   ⁄boolr&  r  rŸ   )rá   r0   r∏   rt   r!  r   rª   rº   r  r    r%  rë   s               r   r  z*BaseEventLoop._create_connection_transportd  s‰   Ë Ë Ä  	◊“ò—‘–‡#–#—%‘%àÿ◊#“#—%‘%àÿ 	L›!+®Cµ—!6‘!6–?òò∏CàJÿ◊0“0ÿêh†
®Fÿ'∏ÿ&;ÿ%9	 1Ò ;Ù ;àIàI ◊3“3∞D∏(¿F—K‘KàI	ÿàLàLàLàLàLàLàLàL¯	ÿèOäO—‘–ÿ¯¯¯‡ò(–"–"s   ¬B ¬B'c             É   Û‹  K  ó |†                     ¶   ´         rt          d¶  ´        Çt          |dt          j        j        ¶  ´        }|t          j        j        u rt          d|õù¶  ´        Ç|t          j        j        u r>	 | †                    ||||¶  ´        É d{V óÜS # t          j	        $ r}|sÇ Y d}~nd}~ww xY w|st          d|õù¶  ´        Ç| †
                    ||||¶  ´        É d{V óÜS )aÑ  Send a file to transport.

        Return the total number of bytes which were sent.

        The method uses high-performance os.sendfile if available.

        file must be a regular file object opened in binary mode.

        offset tells from where to start reading the file. If specified,
        count is the total number of bytes to transmit as opposed to
        sending the file until EOF is reached. File position is updated on
        return or also in case of error in which case file.tell()
        can be used to figure out the number of bytes
        which were sent.

        fallback set to True makes asyncio to manually read and send
        the file when the platform does not support the sendfile syscall
        (e.g. Windows or SSL socket on Unix).

        Raise SendfileNotAvailableError if the system does not support
        sendfile syscall and fallback is False.
        zTransport is closing⁄_sendfile_compatiblez(sendfile is not supported for transport NzHfallback is disabled and native sendfile is not supported for transport )rã   rê   r   r   ⁄_SendfileMode⁄UNSUPPORTED⁄
TRY_NATIVE⁄_sendfile_nativer   rŒ  ⁄_sendfile_fallback)rá   rë   r–  r—  r“  r…  rÊ  rl   s           r   ⁄sendfilezBaseEventLoop.sendfileÄ  så  Ë Ë Ä 0 ◊“—!‘! 	7›–5—6‘6–6›êy–"8› ‘.‘:Ò<Ù <à‡ï9‘*‘6–6–6›ÿH∏9–H–HÒJÙ J J‡ï9‘*‘5–5–5ÿ!◊2“2∞9∏dÿ39∏5ÒBÙ B B B B B B B B¯Â‘7   ÿ ÿ    ¯¯¯¯¯¯¯  	:›9ÿ+49 9Ò:Ù : : ◊,“,®Y∏ÿ-3∞UÒ<Ù < < < < < < < 	<s   ¡?B ¬B9¬,B4¬4B9c              É   Û.   K  ó t          j        d¶  ´        Ç)Nz!sendfile syscall is not supportedr’  )rá   rà   r–  r—  r“  s        r   r  zBaseEventLoop._sendfile_nativeØ  s   Ë Ë Ä ›‘2ÿ/Ò1Ù 1 	1r    c              É   Ûä  K  ó |r|†                     |¶  ´         |rt          |d¶  ´        nd}t          |¶  ´        }d}t          |¶  ´        }	 	 |rct          ||z
  |¶  ´        }|dk    rJ||dk    r(t	          |d¶  ´        r|†                     ||z   ¶  ´         |†                    ¶   ´         É d {V óÜ S t          |¶  ´        d |Ö         }	| †                    d |j        |	¶  ´        É d {V óÜ}
|
sJ||dk    r(t	          |d¶  ´        r|†                     ||z   ¶  ´         |†                    ¶   ´         É d {V óÜ S |†	                    ¶   ´         É d {V óÜ |†
                    |	d |
Ö         ¶  ´         ||
z  }êå(# |dk    r(t	          |d¶  ´        r|†                     ||z   ¶  ´         |†                    ¶   ´         É d {V óÜ w xY w)Ni @  r   Trÿ  )rÿ  rŸ  r€  rx   r)   r¶   r‹  rÆ  r›  rç   ⁄write)rá   rà   r–  r—  r“  rﬂ  r‡  r·  rG   r‚  r„  s              r   r  z BaseEventLoop._sendfile_fallback≥  s  Ë Ë Ä ÿ 	ÿèIäIêf—‘–ÿ).–9ïCòòu—%‘%–%∞Eà	›ò	—"‘"àÿà
›)®&—1‘1à	"#ÿ *› #†E®J—$6∏	— B‘ BêIÿ †Aí~ê~ÿ) òAä~à~•'®$∞—"7‘"7à~ÿó	í	ò&†:—-—.‘.–.ÿó-í-ë/î/–!–!–!–!–!–!–!–!ı "†#ëî†z®	†z‘2êÿ!◊1“1∞$∏º¿t—L‘L–L–L–L–L–L–Lêÿ